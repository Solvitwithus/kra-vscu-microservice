2026-02-03T04:03:44.932139Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:04:14.935210Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:23: ‚ùå Retry worker error: Failed to acquire connection from pool: Connection pool timed out
2026-02-03T04:04:14.935346Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:04:17.094774Z  WARN ThreadId(13) sqlx::pool::acquire: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/pool/inner.rs:302: acquired connection, but time to acquire exceeded slow threshold aquired_after_secs=2.158886186 slow_acquire_threshold_secs=2.0
2026-02-03T04:04:17.709024Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=613.905566ms elapsed_secs=0.613905566
2026-02-03T04:04:17.709253Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:04:44.927792Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:04:45.661149Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=409.498723ms elapsed_secs=0.409498723
2026-02-03T04:04:45.661374Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:05:14.928504Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:05:15.557603Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=307.218011ms elapsed_secs=0.307218011
2026-02-03T04:05:15.557836Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:05:44.928937Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:05:45.526714Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=278.484593ms elapsed_secs=0.278484593
2026-02-03T04:05:45.526990Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:06:14.928067Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:06:15.552572Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=307.01959ms elapsed_secs=0.30701959
2026-02-03T04:06:15.552804Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:06:44.928854Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:06:45.549279Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=306.943934ms elapsed_secs=0.306943934
2026-02-03T04:06:45.549510Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:07:14.928417Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:07:15.545694Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=306.996245ms elapsed_secs=0.306996245
2026-02-03T04:07:15.545968Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:07:43.922751Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:07:44.535784Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=307.294011ms elapsed_secs=0.307294011
2026-02-03T04:07:44.536013Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:08:13.922229Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:08:14.751626Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=410.239486ms elapsed_secs=0.410239486
2026-02-03T04:08:14.751858Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:08:43.921461Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:08:44.463361Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=272.236504ms elapsed_secs=0.272236504
2026-02-03T04:08:44.463616Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:09:13.921648Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:09:14.557131Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=306.369114ms elapsed_secs=0.306369114
2026-02-03T04:09:14.557277Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:09:43.924798Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:09:44.532697Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=306.77519ms elapsed_secs=0.30677519
2026-02-03T04:09:44.532881Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:10:13.922155Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:10:14.518825Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=323.93186ms elapsed_secs=0.32393186
2026-02-03T04:10:14.519096Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:10:43.921825Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:10:44.611201Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=307.116017ms elapsed_secs=0.307116017
2026-02-03T04:10:44.611382Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:11:13.921712Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:11:14.602291Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=306.84177ms elapsed_secs=0.30684177
2026-02-03T04:11:14.602476Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:11:43.925704Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:11:44.610474Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=307.026313ms elapsed_secs=0.307026313
2026-02-03T04:11:44.610749Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:12:13.921853Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:12:14.513110Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=318.866173ms elapsed_secs=0.318866173
2026-02-03T04:12:14.513235Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:12:43.921600Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:12:44.635336Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=323.905762ms elapsed_secs=0.323905762
2026-02-03T04:12:44.635593Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:13:13.921343Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:13:14.616376Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=307.217429ms elapsed_secs=0.307217429
2026-02-03T04:13:14.616700Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:13:45.657512Z  INFO ThreadId(01) vscu: src/main.rs:30: Starting VSCU middleware service
2026-02-03T04:13:45.658354Z  WARN ThreadId(01) sqlx_postgres::options::parse: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-postgres-0.8.6/src/options/parse.rs:107: ignoring unrecognized connect parameter key=channel_binding value=require
2026-02-03T04:13:47.993352Z  WARN ThreadId(01) sqlx::pool::acquire: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/pool/inner.rs:302: acquired connection, but time to acquire exceeded slow threshold aquired_after_secs=2.334745662 slow_acquire_threshold_secs=2.0
2026-02-03T04:13:47.993853Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:13:47.995412Z  INFO ThreadId(01) vscu: src/main.rs:64: Server listening on 0.0.0.0:8000
2026-02-03T04:13:48.913463Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=623.958783ms elapsed_secs=0.623958783
2026-02-03T04:13:48.913683Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:13:58.246602Z  INFO ThreadId(12) vscu::product_management::items_save_items: src/product_management/items_save_items.rs:33: Bearer token received
2026-02-03T04:13:58.246667Z  INFO ThreadId(12) vscu::utils::bearer: src/utils/bearer.rs:11: MY TOKEN: "JOusKLDysCAmGrha6ftt87lkJkrZzupmOTrLH0fv2NiNCldRdmtSbMVTM5ro9l9l"
2026-02-03T04:13:59.155368Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"credentials\".\"id\", \"credentials\".\"company_id\", \"credentials\".\"environment_name\", ‚Ä¶" db.statement="\n\nSELECT \"credentials\".\"id\", \"credentials\".\"company_id\", \"credentials\".\"environment_name\", \"credentials\".\"environment_url\", \"credentials\".\"pin\", \"credentials\".\"branch_id\", \"credentials\".\"device_serial\", \"credentials\".\"api_key\" FROM \"credentials\" WHERE \"credentials\".\"api_key\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=640.361065ms elapsed_secs=0.640361065
2026-02-03T04:14:02.001174Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="INSERT INTO \"item_master\" (\"tin\", ‚Ä¶" db.statement="\n\nINSERT INTO \"item_master\" (\"tin\", \"bhf_id\", \"status\", \"item_cd\", \"item_cls_cd\", \"item_ty_cd\", \"item_nm\", \"item_std_nm\", \"orgn_nat_cd\", \"pkg_unit_cd\", \"qty_unit_cd\", \"tax_ty_cd\", \"btch_no\", \"bcd\", \"dft_prc\", \"grp_prc_l1\", \"grp_prc_l2\", \"grp_prc_l3\", \"grp_prc_l4\", \"grp_prc_l5\", \"add_info\", \"sfty_qty\", \"isrc_aplcb_yn\", \"use_yn\", \"regr_nm\", \"regr_id\", \"modr_nm\", \"modr_id\") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22, $23, $24, $25, $26, $27, $28) RETURNING \"id\", \"tin\", \"bhf_id\", \"status\", \"item_cd\", \"item_cls_cd\", \"item_ty_cd\", \"item_nm\", \"item_std_nm\", \"orgn_nat_cd\", \"pkg_unit_cd\", \"qty_unit_cd\", \"tax_ty_cd\", \"btch_no\", \"bcd\", \"dft_prc\", \"grp_prc_l1\", \"grp_prc_l2\", \"grp_prc_l3\", \"grp_prc_l4\", \"grp_prc_l5\", \"add_info\", \"sfty_qty\", \"isrc_aplcb_yn\", \"use_yn\", \"regr_nm\", \"regr_id\", \"modr_nm\", \"modr_id\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=597.116208ms elapsed_secs=0.597116208
2026-02-03T04:14:02.277874Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="ROLLBACK" db.statement="" rows_affected=0 rows_returned=0 elapsed=276.41199ms elapsed_secs=0.27641199
2026-02-03T04:14:02.278228Z ERROR ThreadId(12) tower_http::trace::on_failure: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tower-http-0.6.8/src/trace/on_failure.rs:93: response failed classification=Status code: 500 Internal Server Error latency=4031 ms
2026-02-03T04:14:17.994926Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:14:18.603601Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=334.236466ms elapsed_secs=0.334236466
2026-02-03T04:14:18.603844Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:14:47.994888Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:14:48.239303Z  INFO ThreadId(12) vscu::product_management::items_save_items: src/product_management/items_save_items.rs:33: Bearer token received
2026-02-03T04:14:48.239378Z  INFO ThreadId(12) vscu::utils::bearer: src/utils/bearer.rs:11: MY TOKEN: "JOusKLDysCAmGrha6ftt87lkJkrZzupmOTrLH0fv2NiNCldRdmtSbMVTM5ro9l9l"
2026-02-03T04:14:48.786951Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"credentials\".\"id\", \"credentials\".\"company_id\", \"credentials\".\"environment_name\", ‚Ä¶" db.statement="\n\nSELECT \"credentials\".\"id\", \"credentials\".\"company_id\", \"credentials\".\"environment_name\", \"credentials\".\"environment_url\", \"credentials\".\"pin\", \"credentials\".\"branch_id\", \"credentials\".\"device_serial\", \"credentials\".\"api_key\" FROM \"credentials\" WHERE \"credentials\".\"api_key\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=277.233249ms elapsed_secs=0.277233249
2026-02-03T04:14:48.824249Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=559.781417ms elapsed_secs=0.559781417
2026-02-03T04:14:48.824432Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:14:51.669805Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="INSERT INTO \"item_master\" (\"tin\", ‚Ä¶" db.statement="\n\nINSERT INTO \"item_master\" (\"tin\", \"bhf_id\", \"status\", \"item_cd\", \"item_cls_cd\", \"item_ty_cd\", \"item_nm\", \"item_std_nm\", \"orgn_nat_cd\", \"pkg_unit_cd\", \"qty_unit_cd\", \"tax_ty_cd\", \"btch_no\", \"bcd\", \"dft_prc\", \"grp_prc_l1\", \"grp_prc_l2\", \"grp_prc_l3\", \"grp_prc_l4\", \"grp_prc_l5\", \"add_info\", \"sfty_qty\", \"isrc_aplcb_yn\", \"use_yn\", \"regr_nm\", \"regr_id\", \"modr_nm\", \"modr_id\") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22, $23, $24, $25, $26, $27, $28) RETURNING \"id\", \"tin\", \"bhf_id\", \"status\", \"item_cd\", \"item_cls_cd\", \"item_ty_cd\", \"item_nm\", \"item_std_nm\", \"orgn_nat_cd\", \"pkg_unit_cd\", \"qty_unit_cd\", \"tax_ty_cd\", \"btch_no\", \"bcd\", \"dft_prc\", \"grp_prc_l1\", \"grp_prc_l2\", \"grp_prc_l3\", \"grp_prc_l4\", \"grp_prc_l5\", \"add_info\", \"sfty_qty\", \"isrc_aplcb_yn\", \"use_yn\", \"regr_nm\", \"regr_id\", \"modr_nm\", \"modr_id\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=613.826754ms elapsed_secs=0.613826754
2026-02-03T04:14:51.976834Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="ROLLBACK" db.statement="" rows_affected=0 rows_returned=0 elapsed=306.692401ms elapsed_secs=0.306692401
2026-02-03T04:14:51.977154Z ERROR ThreadId(13) tower_http::trace::on_failure: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tower-http-0.6.8/src/trace/on_failure.rs:93: response failed classification=Status code: 500 Internal Server Error latency=3738 ms
2026-02-03T04:15:17.994165Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:15:18.533808Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=267.877706ms elapsed_secs=0.267877706
2026-02-03T04:15:18.534012Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:15:47.994173Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:15:48.602572Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=335.368001ms elapsed_secs=0.335368001
2026-02-03T04:15:48.602796Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:16:17.994520Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:16:18.928079Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=660.787801ms elapsed_secs=0.660787801
2026-02-03T04:16:18.928300Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:16:47.994964Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:16:48.552024Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=279.791429ms elapsed_secs=0.279791429
2026-02-03T04:16:48.552256Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:17:17.994716Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:17:18.638234Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=362.780158ms elapsed_secs=0.362780158
2026-02-03T04:17:18.638418Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:17:47.994704Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:17:48.641536Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=370.843514ms elapsed_secs=0.370843514
2026-02-03T04:17:48.641790Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:18:17.994984Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:18:18.545052Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=275.894897ms elapsed_secs=0.275894897
2026-02-03T04:18:18.545276Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:18:47.994785Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:18:48.643962Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=376.381544ms elapsed_secs=0.376381544
2026-02-03T04:18:48.644197Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:19:17.994622Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:19:18.544942Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=278.076384ms elapsed_secs=0.278076384
2026-02-03T04:19:18.545174Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:19:47.994855Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:19:48.642891Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=374.640136ms elapsed_secs=0.374640136
2026-02-03T04:19:48.643114Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:20:17.994472Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:20:18.566825Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=297.344853ms elapsed_secs=0.297344853
2026-02-03T04:20:18.567087Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:20:47.994290Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:20:48.690193Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=396.661096ms elapsed_secs=0.396661096
2026-02-03T04:20:48.690421Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:21:17.994904Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:21:18.601174Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=331.209632ms elapsed_secs=0.331209632
2026-02-03T04:21:18.601425Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:21:47.994842Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:21:48.611617Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=306.955141ms elapsed_secs=0.306955141
2026-02-03T04:21:48.611815Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:22:17.994280Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:22:18.568126Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=292.579951ms elapsed_secs=0.292579951
2026-02-03T04:22:18.568270Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:22:47.994443Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:22:48.624202Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=351.30351ms elapsed_secs=0.35130351
2026-02-03T04:22:48.624381Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:23:17.994894Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:23:18.545941Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=282.755683ms elapsed_secs=0.282755683
2026-02-03T04:23:18.546091Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:23:47.995618Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:23:48.632602Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=342.13006ms elapsed_secs=0.34213006
2026-02-03T04:23:48.632783Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:24:14.654607Z  INFO ThreadId(13) vscu::product_management::items_save_items: src/product_management/items_save_items.rs:33: Bearer token received
2026-02-03T04:24:14.654682Z  INFO ThreadId(13) vscu::utils::bearer: src/utils/bearer.rs:11: MY TOKEN: "JOusKLDysCAmGrha6ftt87lkJkrZzupmOTrLH0fv2NiNCldRdmtSbMVTM5ro9l9l"
2026-02-03T04:24:15.199894Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"credentials\".\"id\", \"credentials\".\"company_id\", \"credentials\".\"environment_name\", ‚Ä¶" db.statement="\n\nSELECT \"credentials\".\"id\", \"credentials\".\"company_id\", \"credentials\".\"environment_name\", \"credentials\".\"environment_url\", \"credentials\".\"pin\", \"credentials\".\"branch_id\", \"credentials\".\"device_serial\", \"credentials\".\"api_key\" FROM \"credentials\" WHERE \"credentials\".\"api_key\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=275.117301ms elapsed_secs=0.275117301
2026-02-03T04:24:16.180128Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="INSERT INTO \"item_master\" (\"tin\", ‚Ä¶" db.statement="\n\nINSERT INTO \"item_master\" (\"tin\", \"bhf_id\", \"status\", \"item_cd\", \"item_cls_cd\", \"item_ty_cd\", \"item_nm\", \"item_std_nm\", \"orgn_nat_cd\", \"pkg_unit_cd\", \"qty_unit_cd\", \"tax_ty_cd\", \"btch_no\", \"bcd\", \"dft_prc\", \"grp_prc_l1\", \"grp_prc_l2\", \"grp_prc_l3\", \"grp_prc_l4\", \"grp_prc_l5\", \"add_info\", \"sfty_qty\", \"isrc_aplcb_yn\", \"use_yn\", \"regr_nm\", \"regr_id\", \"modr_nm\", \"modr_id\") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22, $23, $24, $25, $26, $27, $28) RETURNING \"id\", \"tin\", \"bhf_id\", \"status\", \"item_cd\", \"item_cls_cd\", \"item_ty_cd\", \"item_nm\", \"item_std_nm\", \"orgn_nat_cd\", \"pkg_unit_cd\", \"qty_unit_cd\", \"tax_ty_cd\", \"btch_no\", \"bcd\", \"dft_prc\", \"grp_prc_l1\", \"grp_prc_l2\", \"grp_prc_l3\", \"grp_prc_l4\", \"grp_prc_l5\", \"add_info\", \"sfty_qty\", \"isrc_aplcb_yn\", \"use_yn\", \"regr_nm\", \"regr_id\", \"modr_nm\", \"modr_id\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=306.999409ms elapsed_secs=0.306999409
2026-02-03T04:24:16.451785Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="ROLLBACK" db.statement="" rows_affected=0 rows_returned=0 elapsed=271.382076ms elapsed_secs=0.271382076
2026-02-03T04:24:16.452076Z ERROR ThreadId(12) tower_http::trace::on_failure: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tower-http-0.6.8/src/trace/on_failure.rs:93: response failed classification=Status code: 500 Internal Server Error latency=1797 ms
2026-02-03T04:24:17.994026Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:24:18.532714Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=266.943041ms elapsed_secs=0.266943041
2026-02-03T04:24:18.532898Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:24:47.994430Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:24:48.560147Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=272.221001ms elapsed_secs=0.272221001
2026-02-03T04:24:48.560500Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:25:17.994191Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:25:18.653337Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=385.875944ms elapsed_secs=0.385875944
2026-02-03T04:25:18.653594Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:26:48.616672Z  INFO ThreadId(01) vscu: src/main.rs:30: Starting VSCU middleware service
2026-02-03T04:26:48.617755Z  WARN ThreadId(01) sqlx_postgres::options::parse: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-postgres-0.8.6/src/options/parse.rs:107: ignoring unrecognized connect parameter key=channel_binding value=require
2026-02-03T04:26:50.618668Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:26:50.618760Z  INFO ThreadId(01) vscu: src/main.rs:64: Server listening on 0.0.0.0:8000
2026-02-03T04:26:51.538013Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=614.097603ms elapsed_secs=0.614097603
2026-02-03T04:26:51.538275Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:27:09.621740Z  INFO ThreadId(11) vscu::product_management::items_save_items: src/product_management/items_save_items.rs:33: Bearer token received
2026-02-03T04:27:09.621820Z  INFO ThreadId(11) vscu::utils::bearer: src/utils/bearer.rs:11: MY TOKEN: "JOusKLDysCAmGrha6ftt87lkJkrZzupmOTrLH0fv2NiNCldRdmtSbMVTM5ro9l9l"
2026-02-03T04:27:10.586506Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"credentials\".\"id\", \"credentials\".\"company_id\", \"credentials\".\"environment_name\", ‚Ä¶" db.statement="\n\nSELECT \"credentials\".\"id\", \"credentials\".\"company_id\", \"credentials\".\"environment_name\", \"credentials\".\"environment_url\", \"credentials\".\"pin\", \"credentials\".\"branch_id\", \"credentials\".\"device_serial\", \"credentials\".\"api_key\" FROM \"credentials\" WHERE \"credentials\".\"api_key\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=687.813104ms elapsed_secs=0.687813104
2026-02-03T04:27:13.657255Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="INSERT INTO \"item_master\" (\"tin\", ‚Ä¶" db.statement="\n\nINSERT INTO \"item_master\" (\"tin\", \"bhf_id\", \"status\", \"item_cd\", \"item_cls_cd\", \"item_ty_cd\", \"item_nm\", \"item_std_nm\", \"orgn_nat_cd\", \"pkg_unit_cd\", \"qty_unit_cd\", \"tax_ty_cd\", \"btch_no\", \"bcd\", \"dft_prc\", \"grp_prc_l1\", \"grp_prc_l2\", \"grp_prc_l3\", \"grp_prc_l4\", \"grp_prc_l5\", \"add_info\", \"sfty_qty\", \"isrc_aplcb_yn\", \"use_yn\", \"regr_nm\", \"regr_id\", \"modr_nm\", \"modr_id\") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22, $23, $24, $25, $26, $27, $28) RETURNING \"id\", \"tin\", \"bhf_id\", \"status\", \"item_cd\", \"item_cls_cd\", \"item_ty_cd\", \"item_nm\", \"item_std_nm\", \"orgn_nat_cd\", \"pkg_unit_cd\", \"qty_unit_cd\", \"tax_ty_cd\", \"btch_no\", \"bcd\", \"dft_prc\", \"grp_prc_l1\", \"grp_prc_l2\", \"grp_prc_l3\", \"grp_prc_l4\", \"grp_prc_l5\", \"add_info\", \"sfty_qty\", \"isrc_aplcb_yn\", \"use_yn\", \"regr_nm\", \"regr_id\", \"modr_nm\", \"modr_id\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=715.956768ms elapsed_secs=0.715956768
2026-02-03T04:27:13.926399Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="ROLLBACK" db.statement="" rows_affected=0 rows_returned=0 elapsed=268.826859ms elapsed_secs=0.268826859
2026-02-03T04:27:13.926781Z ERROR ThreadId(02) tower_http::trace::on_failure: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tower-http-0.6.8/src/trace/on_failure.rs:93: response failed classification=Status code: 500 Internal Server Error latency=4305 ms
2026-02-03T04:27:20.618931Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:27:21.235638Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=307.106761ms elapsed_secs=0.307106761
2026-02-03T04:27:21.235862Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:27:50.619050Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:27:51.547815Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=615.052017ms elapsed_secs=0.615052017
2026-02-03T04:27:51.548049Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:28:20.618728Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:28:21.167279Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=276.263904ms elapsed_secs=0.276263904
2026-02-03T04:28:21.167459Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:28:50.618805Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:28:51.231883Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=290.187634ms elapsed_secs=0.290187634
2026-02-03T04:28:51.232117Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:29:20.618880Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:29:21.253442Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=307.702119ms elapsed_secs=0.307702119
2026-02-03T04:29:21.253719Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:29:50.619200Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:29:51.257063Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=307.063676ms elapsed_secs=0.307063676
2026-02-03T04:29:51.257288Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:30:20.618418Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:30:21.169930Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=267.92525ms elapsed_secs=0.26792525
2026-02-03T04:30:21.170164Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:30:50.619284Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:30:51.264368Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=306.735037ms elapsed_secs=0.306735037
2026-02-03T04:30:51.264640Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:31:20.618423Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:31:21.268383Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=307.350476ms elapsed_secs=0.307350476
2026-02-03T04:31:21.268653Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:31:50.618729Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:31:51.272187Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=307.147321ms elapsed_secs=0.307147321
2026-02-03T04:31:51.272423Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:32:20.619178Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:32:21.275903Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=368.739648ms elapsed_secs=0.368739648
2026-02-03T04:32:21.276133Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:32:50.619075Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:32:51.278055Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=307.149006ms elapsed_secs=0.307149006
2026-02-03T04:32:51.278291Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:33:20.618678Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:33:21.380177Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=409.832103ms elapsed_secs=0.409832103
2026-02-03T04:33:21.380420Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:33:50.618815Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:33:51.380189Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=409.383104ms elapsed_secs=0.409383104
2026-02-03T04:33:51.380415Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:34:20.618023Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:34:21.170895Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=280.623368ms elapsed_secs=0.280623368
2026-02-03T04:34:21.171064Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:34:27.328204Z  INFO ThreadId(02) vscu::product_management::items_save_items: src/product_management/items_save_items.rs:33: Bearer token received
2026-02-03T04:34:27.328264Z  INFO ThreadId(02) vscu::utils::bearer: src/utils/bearer.rs:11: MY TOKEN: "JOusKLDysCAmGrha6ftt87lkJkrZzupmOTrLH0fv2NiNCldRdmtSbMVTM5ro9l9l"
2026-02-03T04:34:28.229836Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"credentials\".\"id\", \"credentials\".\"company_id\", \"credentials\".\"environment_name\", ‚Ä¶" db.statement="\n\nSELECT \"credentials\".\"id\", \"credentials\".\"company_id\", \"credentials\".\"environment_name\", \"credentials\".\"environment_url\", \"credentials\".\"pin\", \"credentials\".\"branch_id\", \"credentials\".\"device_serial\", \"credentials\".\"api_key\" FROM \"credentials\" WHERE \"credentials\".\"api_key\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=630.688682ms elapsed_secs=0.630688682
2026-02-03T04:34:29.371167Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="INSERT INTO \"item_master\" (\"tin\", ‚Ä¶" db.statement="\n\nINSERT INTO \"item_master\" (\"tin\", \"bhf_id\", \"status\", \"item_cd\", \"item_cls_cd\", \"item_ty_cd\", \"item_nm\", \"item_std_nm\", \"orgn_nat_cd\", \"pkg_unit_cd\", \"qty_unit_cd\", \"tax_ty_cd\", \"btch_no\", \"bcd\", \"dft_prc\", \"grp_prc_l1\", \"grp_prc_l2\", \"grp_prc_l3\", \"grp_prc_l4\", \"grp_prc_l5\", \"add_info\", \"sfty_qty\", \"isrc_aplcb_yn\", \"use_yn\", \"regr_nm\", \"regr_id\", \"modr_nm\", \"modr_id\") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22, $23, $24, $25, $26, $27, $28) RETURNING \"id\", \"tin\", \"bhf_id\", \"status\", \"item_cd\", \"item_cls_cd\", \"item_ty_cd\", \"item_nm\", \"item_std_nm\", \"orgn_nat_cd\", \"pkg_unit_cd\", \"qty_unit_cd\", \"tax_ty_cd\", \"btch_no\", \"bcd\", \"dft_prc\", \"grp_prc_l1\", \"grp_prc_l2\", \"grp_prc_l3\", \"grp_prc_l4\", \"grp_prc_l5\", \"add_info\", \"sfty_qty\", \"isrc_aplcb_yn\", \"use_yn\", \"regr_nm\", \"regr_id\", \"modr_nm\", \"modr_id\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=585.257369ms elapsed_secs=0.585257369
2026-02-03T04:34:29.673842Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="ROLLBACK" db.statement="" rows_affected=0 rows_returned=0 elapsed=302.397645ms elapsed_secs=0.302397645
2026-02-03T04:34:29.674084Z ERROR ThreadId(12) tower_http::trace::on_failure: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tower-http-0.6.8/src/trace/on_failure.rs:93: response failed classification=Status code: 500 Internal Server Error latency=2346 ms
2026-02-03T04:34:47.162887Z  INFO ThreadId(12) vscu::product_management::items_save_items: src/product_management/items_save_items.rs:33: Bearer token received
2026-02-03T04:34:47.163026Z  INFO ThreadId(12) vscu::utils::bearer: src/utils/bearer.rs:11: MY TOKEN: "JOusKLDysCAmGrha6ftt87lkJkrZzupmOTrLH0fv2NiNCldRdmtSbMVTM5ro9l9l"
2026-02-03T04:34:47.709483Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"credentials\".\"id\", \"credentials\".\"company_id\", \"credentials\".\"environment_name\", ‚Ä¶" db.statement="\n\nSELECT \"credentials\".\"id\", \"credentials\".\"company_id\", \"credentials\".\"environment_name\", \"credentials\".\"environment_url\", \"credentials\".\"pin\", \"credentials\".\"branch_id\", \"credentials\".\"device_serial\", \"credentials\".\"api_key\" FROM \"credentials\" WHERE \"credentials\".\"api_key\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=280.100249ms elapsed_secs=0.280100249
2026-02-03T04:34:48.616947Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="INSERT INTO \"item_master\" (\"tin\", ‚Ä¶" db.statement="\n\nINSERT INTO \"item_master\" (\"tin\", \"bhf_id\", \"status\", \"item_cd\", \"item_cls_cd\", \"item_ty_cd\", \"item_nm\", \"item_std_nm\", \"orgn_nat_cd\", \"pkg_unit_cd\", \"qty_unit_cd\", \"tax_ty_cd\", \"btch_no\", \"bcd\", \"dft_prc\", \"grp_prc_l1\", \"grp_prc_l2\", \"grp_prc_l3\", \"grp_prc_l4\", \"grp_prc_l5\", \"add_info\", \"sfty_qty\", \"isrc_aplcb_yn\", \"use_yn\", \"regr_nm\", \"regr_id\", \"modr_nm\", \"modr_id\") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22, $23, $24, $25, $26, $27, $28) RETURNING \"id\", \"tin\", \"bhf_id\", \"status\", \"item_cd\", \"item_cls_cd\", \"item_ty_cd\", \"item_nm\", \"item_std_nm\", \"orgn_nat_cd\", \"pkg_unit_cd\", \"qty_unit_cd\", \"tax_ty_cd\", \"btch_no\", \"bcd\", \"dft_prc\", \"grp_prc_l1\", \"grp_prc_l2\", \"grp_prc_l3\", \"grp_prc_l4\", \"grp_prc_l5\", \"add_info\", \"sfty_qty\", \"isrc_aplcb_yn\", \"use_yn\", \"regr_nm\", \"regr_id\", \"modr_nm\", \"modr_id\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=343.19946ms elapsed_secs=0.34319946
2026-02-03T04:34:48.893157Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="ROLLBACK" db.statement="" rows_affected=0 rows_returned=0 elapsed=275.904183ms elapsed_secs=0.275904183
2026-02-03T04:34:48.893392Z ERROR ThreadId(11) tower_http::trace::on_failure: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tower-http-0.6.8/src/trace/on_failure.rs:93: response failed classification=Status code: 500 Internal Server Error latency=1731 ms
2026-02-03T04:34:50.619090Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:34:51.176874Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=287.611898ms elapsed_secs=0.287611898
2026-02-03T04:34:51.177104Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:35:20.618365Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:35:21.383860Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=410.697476ms elapsed_secs=0.410697476
2026-02-03T04:35:21.384095Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:35:50.618076Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:35:51.281780Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=307.323578ms elapsed_secs=0.307323578
2026-02-03T04:35:51.282013Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:36:20.619047Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:36:21.283335Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=373.46326ms elapsed_secs=0.37346326
2026-02-03T04:36:21.283596Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:36:50.618646Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:36:51.285042Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=307.0668ms elapsed_secs=0.3070668
2026-02-03T04:36:51.285279Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:37:20.619257Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:37:21.286870Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=307.059535ms elapsed_secs=0.307059535
2026-02-03T04:37:21.287104Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:37:50.619068Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:37:51.288397Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=306.924024ms elapsed_secs=0.306924024
2026-02-03T04:37:51.288639Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:38:20.618874Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:38:21.188147Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=289.901194ms elapsed_secs=0.289901194
2026-02-03T04:38:21.188372Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:38:50.618737Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:38:51.292711Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=307.109671ms elapsed_secs=0.307109671
2026-02-03T04:38:51.292934Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:39:20.618410Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:39:21.295812Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=307.819344ms elapsed_secs=0.307819344
2026-02-03T04:39:21.296039Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:39:50.618652Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:39:51.297752Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=307.035632ms elapsed_secs=0.307035632
2026-02-03T04:39:51.297994Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:40:20.618445Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:40:21.277444Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=285.041918ms elapsed_secs=0.285041918
2026-02-03T04:40:21.277692Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:50:52.756122Z  INFO ThreadId(01) vscu: src/main.rs:30: Starting VSCU middleware service
2026-02-03T04:50:52.756725Z  WARN ThreadId(01) sqlx_postgres::options::parse: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-postgres-0.8.6/src/options/parse.rs:107: ignoring unrecognized connect parameter key=channel_binding value=require
2026-02-03T04:50:55.657247Z  WARN ThreadId(01) sqlx::pool::acquire: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/pool/inner.rs:302: acquired connection, but time to acquire exceeded slow threshold aquired_after_secs=2.900333258 slow_acquire_threshold_secs=2.0
2026-02-03T04:50:55.658208Z  INFO ThreadId(01) vscu: src/main.rs:64: Server listening on 0.0.0.0:8000
2026-02-03T04:50:55.658626Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:50:56.680825Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=716.480381ms elapsed_secs=0.716480381
2026-02-03T04:50:56.680969Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:50:57.924251Z  INFO ThreadId(02) vscu::product_management::items_save_items: src/product_management/items_save_items.rs:33: Bearer token received
2026-02-03T04:50:57.924296Z  INFO ThreadId(02) vscu::utils::bearer: src/utils/bearer.rs:11: MY TOKEN: "JOusKLDysCAmGrha6ftt87lkJkrZzupmOTrLH0fv2NiNCldRdmtSbMVTM5ro9l9l"
2026-02-03T04:50:58.808726Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"credentials\".\"id\", \"credentials\".\"company_id\", \"credentials\".\"environment_name\", ‚Ä¶" db.statement="\n\nSELECT \"credentials\".\"id\", \"credentials\".\"company_id\", \"credentials\".\"environment_name\", \"credentials\".\"environment_url\", \"credentials\".\"pin\", \"credentials\".\"branch_id\", \"credentials\".\"device_serial\", \"credentials\".\"api_key\" FROM \"credentials\" WHERE \"credentials\".\"api_key\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=616.0178ms elapsed_secs=0.6160178
2026-02-03T04:51:01.808754Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="INSERT INTO \"item_master\" (\"tin\", ‚Ä¶" db.statement="\n\nINSERT INTO \"item_master\" (\"tin\", \"bhf_id\", \"status\", \"item_cd\", \"item_cls_cd\", \"item_ty_cd\", \"item_nm\", \"item_std_nm\", \"orgn_nat_cd\", \"pkg_unit_cd\", \"qty_unit_cd\", \"tax_ty_cd\", \"btch_no\", \"bcd\", \"dft_prc\", \"grp_prc_l1\", \"grp_prc_l2\", \"grp_prc_l3\", \"grp_prc_l4\", \"grp_prc_l5\", \"add_info\", \"sfty_qty\", \"isrc_aplcb_yn\", \"use_yn\", \"regr_nm\", \"regr_id\", \"modr_nm\", \"modr_id\") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22, $23, $24, $25, $26, $27, $28) RETURNING \"id\", \"tin\", \"bhf_id\", \"status\", \"item_cd\", \"item_cls_cd\", \"item_ty_cd\", \"item_nm\", \"item_std_nm\", \"orgn_nat_cd\", \"pkg_unit_cd\", \"qty_unit_cd\", \"tax_ty_cd\", \"btch_no\", \"bcd\", \"dft_prc\", \"grp_prc_l1\", \"grp_prc_l2\", \"grp_prc_l3\", \"grp_prc_l4\", \"grp_prc_l5\", \"add_info\", \"sfty_qty\", \"isrc_aplcb_yn\", \"use_yn\", \"regr_nm\", \"regr_id\", \"modr_nm\", \"modr_id\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=724.473546ms elapsed_secs=0.724473546
2026-02-03T04:51:02.096881Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="ROLLBACK" db.statement="" rows_affected=0 rows_returned=0 elapsed=287.930025ms elapsed_secs=0.287930025
2026-02-03T04:51:02.097207Z ERROR ThreadId(02) tower_http::trace::on_failure: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tower-http-0.6.8/src/trace/on_failure.rs:93: response failed classification=Status code: 500 Internal Server Error latency=4173 ms
2026-02-03T04:51:25.658809Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:51:26.272950Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=343.804807ms elapsed_secs=0.343804807
2026-02-03T04:51:26.273128Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:51:55.658914Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:51:56.786727Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=818.504875ms elapsed_secs=0.818504875
2026-02-03T04:51:56.786900Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:52:25.659091Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:52:26.276303Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=304.87638ms elapsed_secs=0.30487638
2026-02-03T04:52:26.276481Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:52:55.658794Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:52:56.278198Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=307.125715ms elapsed_secs=0.307125715
2026-02-03T04:52:56.278427Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:53:25.658923Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:53:26.240106Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=267.362508ms elapsed_secs=0.267362508
2026-02-03T04:53:26.240323Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:53:55.658871Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:53:56.282054Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=306.796931ms elapsed_secs=0.306796931
2026-02-03T04:53:56.282199Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:54:09.019869Z  INFO ThreadId(02) vscu::product_management::items_save_items: src/product_management/items_save_items.rs:33: Bearer token received
2026-02-03T04:54:09.019916Z  INFO ThreadId(02) vscu::utils::bearer: src/utils/bearer.rs:11: MY TOKEN: "JOusKLDysCAmGrha6ftt87lkJkrZzupmOTrLH0fv2NiNCldRdmtSbMVTM5ro9l9l"
2026-02-03T04:54:09.569762Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"credentials\".\"id\", \"credentials\".\"company_id\", \"credentials\".\"environment_name\", ‚Ä¶" db.statement="\n\nSELECT \"credentials\".\"id\", \"credentials\".\"company_id\", \"credentials\".\"environment_name\", \"credentials\".\"environment_url\", \"credentials\".\"pin\", \"credentials\".\"branch_id\", \"credentials\".\"device_serial\", \"credentials\".\"api_key\" FROM \"credentials\" WHERE \"credentials\".\"api_key\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=279.81198ms elapsed_secs=0.27981198
2026-02-03T04:54:10.458085Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="INSERT INTO \"item_master\" (\"tin\", ‚Ä¶" db.statement="\n\nINSERT INTO \"item_master\" (\"tin\", \"bhf_id\", \"status\", \"item_cd\", \"item_cls_cd\", \"item_ty_cd\", \"item_nm\", \"item_std_nm\", \"orgn_nat_cd\", \"pkg_unit_cd\", \"qty_unit_cd\", \"tax_ty_cd\", \"btch_no\", \"bcd\", \"dft_prc\", \"grp_prc_l1\", \"grp_prc_l2\", \"grp_prc_l3\", \"grp_prc_l4\", \"grp_prc_l5\", \"add_info\", \"sfty_qty\", \"isrc_aplcb_yn\", \"use_yn\", \"regr_nm\", \"regr_id\", \"modr_nm\", \"modr_id\") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22, $23, $24, $25, $26, $27, $28) RETURNING \"id\", \"tin\", \"bhf_id\", \"status\", \"item_cd\", \"item_cls_cd\", \"item_ty_cd\", \"item_nm\", \"item_std_nm\", \"orgn_nat_cd\", \"pkg_unit_cd\", \"qty_unit_cd\", \"tax_ty_cd\", \"btch_no\", \"bcd\", \"dft_prc\", \"grp_prc_l1\", \"grp_prc_l2\", \"grp_prc_l3\", \"grp_prc_l4\", \"grp_prc_l5\", \"add_info\", \"sfty_qty\", \"isrc_aplcb_yn\", \"use_yn\", \"regr_nm\", \"regr_id\", \"modr_nm\", \"modr_id\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=299.143104ms elapsed_secs=0.299143104
2026-02-03T04:54:10.822147Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="ROLLBACK" db.statement="" rows_affected=0 rows_returned=0 elapsed=363.734942ms elapsed_secs=0.363734942
2026-02-03T04:54:10.822455Z ERROR ThreadId(02) tower_http::trace::on_failure: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tower-http-0.6.8/src/trace/on_failure.rs:93: response failed classification=Status code: 500 Internal Server Error latency=1802 ms
2026-02-03T04:55:13.060951Z  INFO ThreadId(01) vscu: src/main.rs:30: Starting VSCU middleware service
2026-02-03T04:55:13.061490Z  WARN ThreadId(01) sqlx_postgres::options::parse: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-postgres-0.8.6/src/options/parse.rs:107: ignoring unrecognized connect parameter key=channel_binding value=require
2026-02-03T04:55:14.975553Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:55:14.975677Z  INFO ThreadId(01) vscu: src/main.rs:64: Server listening on 0.0.0.0:8000
2026-02-03T04:55:15.945927Z  INFO ThreadId(05) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=683.532155ms elapsed_secs=0.683532155
2026-02-03T04:55:15.946082Z  INFO ThreadId(05) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:55:37.917631Z  INFO ThreadId(05) vscu::sales::routing: src/sales/routing.rs:39: Bearer token received
2026-02-03T04:55:37.917679Z  INFO ThreadId(05) vscu::utils::bearer: src/utils/bearer.rs:11: MY TOKEN: "JOusKLDysCAmGrha6ftt87lkJkrZzupmOTrLH0fv2NiNCldRdmtSbMVTM5ro9l9l"
2026-02-03T04:55:38.780835Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"credentials\".\"id\", \"credentials\".\"company_id\", \"credentials\".\"environment_name\", ‚Ä¶" db.statement="\n\nSELECT \"credentials\".\"id\", \"credentials\".\"company_id\", \"credentials\".\"environment_name\", \"credentials\".\"environment_url\", \"credentials\".\"pin\", \"credentials\".\"branch_id\", \"credentials\".\"device_serial\", \"credentials\".\"api_key\" FROM \"credentials\" WHERE \"credentials\".\"api_key\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=592.310247ms elapsed_secs=0.592310247
2026-02-03T04:55:41.136374Z  WARN ThreadId(05) sqlx::pool::acquire: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/pool/inner.rs:302: acquired connection, but time to acquire exceeded slow threshold aquired_after_secs=2.355190916 slow_acquire_threshold_secs=2.0
2026-02-03T04:55:42.363996Z  INFO ThreadId(05) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"api_key\" = $1 ORDER BY \"sales\".\"generated_invc_no\" DESC LIMIT $2\n" rows_affected=0 rows_returned=0 elapsed=627.691396ms elapsed_secs=0.627691396
2026-02-03T04:55:43.900451Z  WARN ThreadId(05) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:125: slow statement: execution time exceeded alert threshold summary="INSERT INTO \"sales\" (\"api_key\", ‚Ä¶" db.statement="\n\nINSERT INTO \"sales\" (\"api_key\", \"status\", \"generated_invc_no\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22, $23, $24, $25, $26, $27, $28, $29, $30, $31, $32, $33, $34, $35, $36, $37, $38, $39, $40, $41, $42, $43, $44) RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=1.535340768s elapsed_secs=1.535340768 slow_threshold=1s
2026-02-03T04:55:43.901155Z  INFO ThreadId(05) vscu::sales::routing: src/sales/routing.rs:174: Inserted invoice #1 with ID 1 for api_key: JOusKLDysCAmGrha6ftt87lkJkrZzupmOTrLH0fv2NiNCldRdmtSbMVTM5ro9l9l
2026-02-03T04:55:44.207242Z  INFO ThreadId(05) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="COMMIT" db.statement="" rows_affected=0 rows_returned=0 elapsed=305.940012ms elapsed_secs=0.305940012
2026-02-03T04:55:44.207367Z  INFO ThreadId(05) vscu::sales::routing: src/sales/routing.rs:195: Successfully inserted 1 invoices. Starting KRA transmission...
2026-02-03T04:55:44.975944Z  INFO ThreadId(05) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:55:45.129029Z  INFO ThreadId(05) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=649.480666ms elapsed_secs=0.649480666
2026-02-03T04:55:45.948321Z  INFO ThreadId(05) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=614.838044ms elapsed_secs=0.614838044
2026-02-03T04:55:45.948539Z  INFO ThreadId(05) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:55:47.586645Z  INFO ThreadId(05) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=614.389365ms elapsed_secs=0.614389365
2026-02-03T04:55:48.508697Z  INFO ThreadId(05) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=614.967705ms elapsed_secs=0.614967705
2026-02-03T04:55:48.509438Z  INFO ThreadId(05) vscu::sales::routing: src/sales/routing.rs:391: Updated record 1 status to PROCESSING
2026-02-03T04:55:48.509477Z  INFO ThreadId(05) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T04:55:48.510093Z  INFO ThreadId(05) vscu::sales::routing: src/sales/routing.rs:315: Sending payload to KRA for invoice #1
2026-02-03T04:55:51.685119Z ERROR ThreadId(05) vscu::sales::routing: src/sales/routing.rs:357: Failed to send to KRA endpoint for record 1: error sending request for url (http://192.168.1.71:8088/trnsSales/saveSales)
2026-02-03T04:55:52.604048Z  INFO ThreadId(05) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=614.091683ms elapsed_secs=0.614091683
2026-02-03T04:55:53.219536Z  INFO ThreadId(05) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=308.213079ms elapsed_secs=0.308213079
2026-02-03T04:56:14.975458Z  INFO ThreadId(05) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:56:15.643089Z  INFO ThreadId(05) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=307.029241ms elapsed_secs=0.307029241
2026-02-03T04:56:15.643272Z  INFO ThreadId(05) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:56:44.976078Z  INFO ThreadId(05) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:56:45.542870Z  INFO ThreadId(05) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=294.35749ms elapsed_secs=0.29435749
2026-02-03T04:56:45.543051Z  INFO ThreadId(05) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:57:14.976723Z  INFO ThreadId(05) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:57:15.954662Z  INFO ThreadId(05) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=614.41927ms elapsed_secs=0.61441927
2026-02-03T04:57:15.954870Z  INFO ThreadId(05) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:57:44.975286Z  INFO ThreadId(05) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:57:45.649685Z  INFO ThreadId(05) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=307.138164ms elapsed_secs=0.307138164
2026-02-03T04:57:45.649826Z  INFO ThreadId(05) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T04:58:14.975569Z  INFO ThreadId(05) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T04:58:15.652483Z  INFO ThreadId(05) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" = $1 AND \"sales\".\"retry_count\" < $2\n" rows_affected=0 rows_returned=0 elapsed=306.56533ms elapsed_secs=0.30656533
2026-02-03T04:58:15.652663Z  INFO ThreadId(05) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 0 failed records to retry
2026-02-03T05:04:18.672310Z  INFO ThreadId(01) vscu: src/main.rs:30: Starting VSCU middleware service
2026-02-03T05:04:18.672807Z  WARN ThreadId(01) sqlx_postgres::options::parse: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-postgres-0.8.6/src/options/parse.rs:107: ignoring unrecognized connect parameter key=channel_binding value=require
2026-02-03T05:04:26.433231Z  WARN ThreadId(01) sqlx::pool::acquire: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/pool/inner.rs:302: acquired connection, but time to acquire exceeded slow threshold aquired_after_secs=7.760277052 slow_acquire_threshold_secs=2.0
2026-02-03T05:04:26.434865Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:04:26.435078Z  INFO ThreadId(01) vscu: src/main.rs:64: Server listening on 0.0.0.0:8000
2026-02-03T05:04:27.455951Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=1 rows_returned=1 elapsed=715.432832ms elapsed_secs=0.715432832
2026-02-03T05:04:27.456420Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 1 failed records to retry
2026-02-03T05:04:27.456454Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:04:30.019213Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=616.635263ms elapsed_secs=0.616635263
2026-02-03T05:04:30.938756Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=614.407853ms elapsed_secs=0.614407853
2026-02-03T05:04:30.939523Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:04:30.939598Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:04:30.939784Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:04:30.939869Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:04:31.535924Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=290.156407ms elapsed_secs=0.290156407
2026-02-03T05:04:32.123138Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=294.147971ms elapsed_secs=0.294147971
2026-02-03T05:04:32.123396Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:04:36.214991Z  INFO ThreadId(13) vscu::sales::routing: src/sales/routing.rs:39: Bearer token received
2026-02-03T05:04:36.215054Z  INFO ThreadId(13) vscu::utils::bearer: src/utils/bearer.rs:11: MY TOKEN: "JOusKLDysCAmGrha6ftt87lkJkrZzupmOTrLH0fv2NiNCldRdmtSbMVTM5ro9l9l"
2026-02-03T05:04:37.050634Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"credentials\".\"id\", \"credentials\".\"company_id\", \"credentials\".\"environment_name\", ‚Ä¶" db.statement="\n\nSELECT \"credentials\".\"id\", \"credentials\".\"company_id\", \"credentials\".\"environment_name\", \"credentials\".\"environment_url\", \"credentials\".\"pin\", \"credentials\".\"branch_id\", \"credentials\".\"device_serial\", \"credentials\".\"api_key\" FROM \"credentials\" WHERE \"credentials\".\"api_key\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=565.257804ms elapsed_secs=0.565257804
2026-02-03T05:04:38.480385Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"api_key\" = $1 ORDER BY \"sales\".\"generated_invc_no\" DESC LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=570.680664ms elapsed_secs=0.570680664
2026-02-03T05:04:39.131637Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="INSERT INTO \"sales\" (\"api_key\", ‚Ä¶" db.statement="\n\nINSERT INTO \"sales\" (\"api_key\", \"status\", \"generated_invc_no\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22, $23, $24, $25, $26, $27, $28, $29, $30, $31, $32, $33, $34, $35, $36, $37, $38, $39, $40, $41, $42, $43, $44) RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=649.722772ms elapsed_secs=0.649722772
2026-02-03T05:04:39.132256Z  INFO ThreadId(02) vscu::sales::routing: src/sales/routing.rs:174: Inserted invoice #2 with ID 2 for api_key: JOusKLDysCAmGrha6ftt87lkJkrZzupmOTrLH0fv2NiNCldRdmtSbMVTM5ro9l9l
2026-02-03T05:04:39.437003Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="COMMIT" db.statement="" rows_affected=0 rows_returned=0 elapsed=304.602911ms elapsed_secs=0.304602911
2026-02-03T05:04:39.437160Z  INFO ThreadId(02) vscu::sales::routing: src/sales/routing.rs:195: Successfully inserted 1 invoices. Starting KRA transmission...
2026-02-03T05:04:40.052995Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=308.316505ms elapsed_secs=0.308316505
2026-02-03T05:04:40.973858Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=631.919168ms elapsed_secs=0.631919168
2026-02-03T05:04:41.895120Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=614.221102ms elapsed_secs=0.614221102
2026-02-03T05:04:41.895803Z  INFO ThreadId(02) vscu::sales::routing: src/sales/routing.rs:391: Updated record 2 status to PROCESSING
2026-02-03T05:04:41.895838Z  INFO ThreadId(02) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:04:41.896336Z  INFO ThreadId(02) vscu::sales::routing: src/sales/routing.rs:315: Sending payload to KRA for invoice #2
2026-02-03T05:04:44.997750Z ERROR ThreadId(02) vscu::sales::routing: src/sales/routing.rs:357: Failed to send to KRA endpoint for record 2: error sending request for url (http://192.168.1.71:8088/trnsSales/saveSales)
2026-02-03T05:04:45.667331Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=290.93525ms elapsed_secs=0.29093525
2026-02-03T05:04:46.219109Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=281.418475ms elapsed_secs=0.281418475
2026-02-03T05:04:56.435155Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:04:57.049085Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=306.408655ms elapsed_secs=0.306408655
2026-02-03T05:04:57.049792Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:04:57.049829Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:04:57.588468Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=268.245277ms elapsed_secs=0.268245277
2026-02-03T05:04:58.168669Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=288.46916ms elapsed_secs=0.28846916
2026-02-03T05:04:58.169306Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:04:58.169359Z  INFO ThreadId(02) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:04:58.169482Z  INFO ThreadId(02) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:04:58.169594Z ERROR ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:04:58.713027Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=272.956463ms elapsed_secs=0.272956463
2026-02-03T05:04:59.300715Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=296.807329ms elapsed_secs=0.296807329
2026-02-03T05:04:59.300931Z ERROR ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:04:59.301011Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:04:59.587995Z  INFO ThreadId(02) vscu::product_management::items_save_items: src/product_management/items_save_items.rs:33: Bearer token received
2026-02-03T05:04:59.588064Z  INFO ThreadId(02) vscu::utils::bearer: src/utils/bearer.rs:11: MY TOKEN: "JOusKLDysCAmGrha6ftt87lkJkrZzupmOTrLH0fv2NiNCldRdmtSbMVTM5ro9l9l"
2026-02-03T05:04:59.852272Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=280.024252ms elapsed_secs=0.280024252
2026-02-03T05:05:00.428339Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=292.002397ms elapsed_secs=0.292002397
2026-02-03T05:05:00.428992Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:05:00.429039Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:05:00.429160Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:05:00.429256Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:05:01.096369Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=396.026431ms elapsed_secs=0.396026431
2026-02-03T05:05:01.685054Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=295.866848ms elapsed_secs=0.295866848
2026-02-03T05:05:01.685281Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:05:01.964517Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"credentials\".\"id\", \"credentials\".\"company_id\", \"credentials\".\"environment_name\", ‚Ä¶" db.statement="\n\nSELECT \"credentials\".\"id\", \"credentials\".\"company_id\", \"credentials\".\"environment_name\", \"credentials\".\"environment_url\", \"credentials\".\"pin\", \"credentials\".\"branch_id\", \"credentials\".\"device_serial\", \"credentials\".\"api_key\" FROM \"credentials\" WHERE \"credentials\".\"api_key\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=590.910023ms elapsed_secs=0.590910023
2026-02-03T05:05:03.091640Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="INSERT INTO \"item_master\" (\"tin\", ‚Ä¶" db.statement="\n\nINSERT INTO \"item_master\" (\"tin\", \"bhf_id\", \"status\", \"item_cd\", \"item_cls_cd\", \"item_ty_cd\", \"item_nm\", \"item_std_nm\", \"orgn_nat_cd\", \"pkg_unit_cd\", \"qty_unit_cd\", \"tax_ty_cd\", \"btch_no\", \"bcd\", \"dft_prc\", \"grp_prc_l1\", \"grp_prc_l2\", \"grp_prc_l3\", \"grp_prc_l4\", \"grp_prc_l5\", \"add_info\", \"sfty_qty\", \"isrc_aplcb_yn\", \"use_yn\", \"regr_nm\", \"regr_id\", \"modr_nm\", \"modr_id\") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22, $23, $24, $25, $26, $27, $28) RETURNING \"id\", \"tin\", \"bhf_id\", \"status\", \"item_cd\", \"item_cls_cd\", \"item_ty_cd\", \"item_nm\", \"item_std_nm\", \"orgn_nat_cd\", \"pkg_unit_cd\", \"qty_unit_cd\", \"tax_ty_cd\", \"btch_no\", \"bcd\", \"dft_prc\", \"grp_prc_l1\", \"grp_prc_l2\", \"grp_prc_l3\", \"grp_prc_l4\", \"grp_prc_l5\", \"add_info\", \"sfty_qty\", \"isrc_aplcb_yn\", \"use_yn\", \"regr_nm\", \"regr_id\", \"modr_nm\", \"modr_id\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=590.212538ms elapsed_secs=0.590212538
2026-02-03T05:05:03.398441Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="ROLLBACK" db.statement="" rows_affected=0 rows_returned=0 elapsed=306.52723ms elapsed_secs=0.30652723
2026-02-03T05:05:03.398836Z ERROR ThreadId(13) tower_http::trace::on_failure: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tower-http-0.6.8/src/trace/on_failure.rs:93: response failed classification=Status code: 500 Internal Server Error latency=3811 ms
2026-02-03T05:05:26.435305Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:05:27.156423Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=410.992327ms elapsed_secs=0.410992327
2026-02-03T05:05:27.157438Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:05:27.157479Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:05:28.077050Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=614.899826ms elapsed_secs=0.614899826
2026-02-03T05:05:28.691227Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=306.467032ms elapsed_secs=0.306467032
2026-02-03T05:05:28.691928Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:05:28.691971Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:05:28.692099Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:05:28.692171Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:05:29.305248Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=306.988843ms elapsed_secs=0.306988843
2026-02-03T05:05:29.919442Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=307.154363ms elapsed_secs=0.307154363
2026-02-03T05:05:29.919682Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:05:29.919750Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:05:30.534032Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.274633ms elapsed_secs=0.307274633
2026-02-03T05:05:31.148744Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=307.310852ms elapsed_secs=0.307310852
2026-02-03T05:05:31.149398Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:05:31.149440Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:05:31.149580Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:05:31.149655Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:05:31.762675Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=306.776915ms elapsed_secs=0.306776915
2026-02-03T05:05:32.360604Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=324.441807ms elapsed_secs=0.324441807
2026-02-03T05:05:32.360820Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:05:56.434885Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:05:57.055232Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=307.443293ms elapsed_secs=0.307443293
2026-02-03T05:05:57.055964Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:05:57.055998Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:05:57.669627Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.335244ms elapsed_secs=0.307335244
2026-02-03T05:05:58.284220Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=307.759161ms elapsed_secs=0.307759161
2026-02-03T05:05:58.284889Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:05:58.284931Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:05:58.285056Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:05:58.285128Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:05:58.898229Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=306.811047ms elapsed_secs=0.306811047
2026-02-03T05:05:59.512433Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=307.156748ms elapsed_secs=0.307156748
2026-02-03T05:05:59.512689Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:05:59.512763Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:06:00.127024Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=306.96988ms elapsed_secs=0.30696988
2026-02-03T05:06:00.742242Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=307.643334ms elapsed_secs=0.307643334
2026-02-03T05:06:00.742889Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:06:00.742931Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:06:00.743028Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:06:00.743118Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:06:01.355925Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.418367ms elapsed_secs=0.307418367
2026-02-03T05:06:01.969936Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=307.037352ms elapsed_secs=0.307037352
2026-02-03T05:06:01.970152Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:06:26.435038Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:06:27.058142Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=330.661292ms elapsed_secs=0.330661292
2026-02-03T05:06:27.059055Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:06:27.059091Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:06:27.672330Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.399778ms elapsed_secs=0.307399778
2026-02-03T05:06:28.286795Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=307.397738ms elapsed_secs=0.307397738
2026-02-03T05:06:28.287413Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:06:28.287440Z  INFO ThreadId(02) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:06:28.287532Z  INFO ThreadId(02) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:06:28.287581Z ERROR ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:06:28.885766Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=291.519637ms elapsed_secs=0.291519637
2026-02-03T05:06:29.515486Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=307.318304ms elapsed_secs=0.307318304
2026-02-03T05:06:29.515741Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:06:29.515828Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:06:30.092343Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=269.823375ms elapsed_secs=0.269823375
2026-02-03T05:06:30.744371Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=307.183795ms elapsed_secs=0.307183795
2026-02-03T05:06:30.745073Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:06:30.745125Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:06:30.745246Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:06:30.745359Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:06:31.358528Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.020874ms elapsed_secs=0.307020874
2026-02-03T05:06:31.973126Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=344.720278ms elapsed_secs=0.344720278
2026-02-03T05:06:31.973369Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:06:56.434840Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:06:57.265005Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=409.345929ms elapsed_secs=0.409345929
2026-02-03T05:06:57.265956Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:06:57.266009Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:06:57.864806Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=292.548611ms elapsed_secs=0.292548611
2026-02-03T05:06:58.494295Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=307.485108ms elapsed_secs=0.307485108
2026-02-03T05:06:58.494944Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:06:58.494982Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:06:58.495080Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:06:58.495150Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:06:59.108207Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.108314ms elapsed_secs=0.307108314
2026-02-03T05:06:59.722483Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=306.690222ms elapsed_secs=0.306690222
2026-02-03T05:06:59.722743Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:06:59.722816Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:07:00.337054Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.361825ms elapsed_secs=0.307361825
2026-02-03T05:07:00.951589Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=307.032397ms elapsed_secs=0.307032397
2026-02-03T05:07:00.952214Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:07:00.952260Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:07:00.952382Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:07:00.952474Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:07:01.500608Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=273.376642ms elapsed_secs=0.273376642
2026-02-03T05:07:02.055122Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=279.135426ms elapsed_secs=0.279135426
2026-02-03T05:07:02.055439Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:07:26.434633Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:07:27.168983Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=412.769442ms elapsed_secs=0.412769442
2026-02-03T05:07:27.169392Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:07:27.169416Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:07:27.779930Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.71228ms elapsed_secs=0.30771228
2026-02-03T05:07:28.395336Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=308.607552ms elapsed_secs=0.308607552
2026-02-03T05:07:28.396029Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:07:28.396084Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:07:28.396234Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:07:28.396380Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:07:29.008382Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=306.498209ms elapsed_secs=0.306498209
2026-02-03T05:07:29.622652Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=313.64012ms elapsed_secs=0.31364012
2026-02-03T05:07:29.622884Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:07:29.622982Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:07:30.237264Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.318863ms elapsed_secs=0.307318863
2026-02-03T05:07:30.852955Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=308.26166ms elapsed_secs=0.30826166
2026-02-03T05:07:30.853677Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:07:30.853723Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:07:30.853869Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:07:30.853970Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:07:31.467247Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=308.625005ms elapsed_secs=0.308625005
2026-02-03T05:07:32.054453Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=281.310613ms elapsed_secs=0.281310613
2026-02-03T05:07:32.054730Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:07:56.434867Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:07:57.055036Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=292.369715ms elapsed_secs=0.292369715
2026-02-03T05:07:57.055918Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:07:57.055959Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:07:57.682984Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=360.441585ms elapsed_secs=0.360441585
2026-02-03T05:07:58.294271Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=319.944541ms elapsed_secs=0.319944541
2026-02-03T05:07:58.294997Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:07:58.295053Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:07:58.295200Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:07:58.295340Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:07:58.890476Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=300.387635ms elapsed_secs=0.300387635
2026-02-03T05:07:59.445944Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=279.075318ms elapsed_secs=0.279075318
2026-02-03T05:07:59.446147Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:07:59.446238Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:07:59.998853Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=271.00082ms elapsed_secs=0.27100082
2026-02-03T05:08:00.649788Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=362.765054ms elapsed_secs=0.362765054
2026-02-03T05:08:00.650366Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:08:00.650416Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:08:00.650537Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:08:00.650671Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:08:01.263372Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=336.880354ms elapsed_secs=0.336880354
2026-02-03T05:08:01.814151Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=279.351232ms elapsed_secs=0.279351232
2026-02-03T05:08:01.814394Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:08:26.435130Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:08:27.046973Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=302.319286ms elapsed_secs=0.302319286
2026-02-03T05:08:27.047840Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:08:27.047883Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:08:27.591072Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=272.649923ms elapsed_secs=0.272649923
2026-02-03T05:08:28.145358Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=277.290115ms elapsed_secs=0.277290115
2026-02-03T05:08:28.146111Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:08:28.146215Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:08:28.146397Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:08:28.146539Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:08:28.790152Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=288.699793ms elapsed_secs=0.288699793
2026-02-03T05:08:29.350632Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=288.657005ms elapsed_secs=0.288657005
2026-02-03T05:08:29.350853Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:08:29.350937Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:08:29.901332Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=279.220549ms elapsed_secs=0.279220549
2026-02-03T05:08:30.502039Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=303.379185ms elapsed_secs=0.303379185
2026-02-03T05:08:30.502689Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:08:30.502753Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:08:30.502875Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:08:30.502984Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:08:31.062654Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=288.73258ms elapsed_secs=0.28873258
2026-02-03T05:08:31.617393Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=277.283223ms elapsed_secs=0.277283223
2026-02-03T05:08:31.617705Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:08:56.434886Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:08:57.027644Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=306.297568ms elapsed_secs=0.306297568
2026-02-03T05:08:57.028705Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:08:57.028792Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:08:57.600944Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=282.195868ms elapsed_secs=0.282195868
2026-02-03T05:08:58.155889Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=278.12271ms elapsed_secs=0.27812271
2026-02-03T05:08:58.156528Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:08:58.156629Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:08:58.156739Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:08:58.156812Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:08:58.811169Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=352.828322ms elapsed_secs=0.352828322
2026-02-03T05:08:59.381129Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=287.469054ms elapsed_secs=0.287469054
2026-02-03T05:08:59.381397Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:08:59.381508Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:09:00.043810Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=310.726864ms elapsed_secs=0.310726864
2026-02-03T05:09:00.651658Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=294.2748ms elapsed_secs=0.2942748
2026-02-03T05:09:00.652413Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:09:00.652459Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:09:00.652627Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:09:00.652753Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:09:01.269972Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=308.115501ms elapsed_secs=0.308115501
2026-02-03T05:09:01.883362Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=331.48338ms elapsed_secs=0.33148338
2026-02-03T05:09:01.883609Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:09:26.435509Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:09:27.017430Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=293.269788ms elapsed_secs=0.293269788
2026-02-03T05:09:27.018473Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:09:27.018526Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:09:27.572167Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=276.207284ms elapsed_secs=0.276207284
2026-02-03T05:09:28.117161Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=277.16418ms elapsed_secs=0.27716418
2026-02-03T05:09:28.117896Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:09:28.117951Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:09:28.118073Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:09:28.118179Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:09:28.695899Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=287.710925ms elapsed_secs=0.287710925
2026-02-03T05:09:29.251976Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=283.991461ms elapsed_secs=0.283991461
2026-02-03T05:09:29.252214Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:09:29.252313Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:09:29.798441Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=274.447128ms elapsed_secs=0.274447128
2026-02-03T05:09:30.376782Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=288.715484ms elapsed_secs=0.288715484
2026-02-03T05:09:30.377375Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:09:30.377428Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:09:30.377582Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:09:30.377693Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:09:30.928656Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=276.649521ms elapsed_secs=0.276649521
2026-02-03T05:09:31.485103Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=285.153225ms elapsed_secs=0.285153225
2026-02-03T05:09:31.485322Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:09:56.435244Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:09:57.064904Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=296.004075ms elapsed_secs=0.296004075
2026-02-03T05:09:57.065868Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:09:57.065932Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:09:57.690570Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=306.847861ms elapsed_secs=0.306847861
2026-02-03T05:09:58.276999Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=278.809141ms elapsed_secs=0.278809141
2026-02-03T05:09:58.277646Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:09:58.277689Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:09:58.277812Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:09:58.277924Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:09:58.876613Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=306.678987ms elapsed_secs=0.306678987
2026-02-03T05:09:59.438965Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=287.968688ms elapsed_secs=0.287968688
2026-02-03T05:09:59.439181Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:09:59.439263Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:09:59.983283Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=272.073006ms elapsed_secs=0.272073006
2026-02-03T05:10:00.570188Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=294.105123ms elapsed_secs=0.294105123
2026-02-03T05:10:00.570827Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:10:00.570852Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:10:00.570924Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:10:00.570971Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:10:01.119718Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=277.325293ms elapsed_secs=0.277325293
2026-02-03T05:10:01.786617Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=306.93171ms elapsed_secs=0.30693171
2026-02-03T05:10:01.786874Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:10:26.434904Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:10:27.067656Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=296.112834ms elapsed_secs=0.296112834
2026-02-03T05:10:27.068647Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:10:27.068708Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:10:27.680257Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=341.194793ms elapsed_secs=0.341194793
2026-02-03T05:10:28.224731Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=273.40463ms elapsed_secs=0.27340463
2026-02-03T05:10:28.225370Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:10:28.225415Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:10:28.225536Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:10:28.225646Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:10:28.819394Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=309.187481ms elapsed_secs=0.309187481
2026-02-03T05:10:29.434060Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=343.866711ms elapsed_secs=0.343866711
2026-02-03T05:10:29.434267Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:10:29.434316Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:10:30.048340Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.179956ms elapsed_secs=0.307179956
2026-02-03T05:10:30.666054Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=310.284243ms elapsed_secs=0.310284243
2026-02-03T05:10:30.666778Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:10:30.666831Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:10:30.666977Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:10:30.667120Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:10:31.206513Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=272.030519ms elapsed_secs=0.272030519
2026-02-03T05:10:31.758452Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=280.055567ms elapsed_secs=0.280055567
2026-02-03T05:10:31.758711Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:10:56.435630Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:10:57.075819Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=301.470949ms elapsed_secs=0.301470949
2026-02-03T05:10:57.076843Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:10:57.076876Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:10:57.700353Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=312.034053ms elapsed_secs=0.312034053
2026-02-03T05:10:58.283997Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=281.104395ms elapsed_secs=0.281104395
2026-02-03T05:10:58.284605Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:10:58.284645Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:10:58.284766Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:10:58.284880Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:10:58.925439Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=350.382838ms elapsed_secs=0.350382838
2026-02-03T05:10:59.528226Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=295.992334ms elapsed_secs=0.295992334
2026-02-03T05:10:59.528578Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:10:59.528657Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:11:00.159034Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=312.149566ms elapsed_secs=0.312149566
2026-02-03T05:11:00.768041Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=307.03053ms elapsed_secs=0.30703053
2026-02-03T05:11:00.768728Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:11:00.768773Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:11:00.768932Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:11:00.769075Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:11:01.382539Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.297183ms elapsed_secs=0.307297183
2026-02-03T05:11:01.996695Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=306.995187ms elapsed_secs=0.306995187
2026-02-03T05:11:01.996952Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:11:26.435262Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:11:27.088573Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=311.674606ms elapsed_secs=0.311674606
2026-02-03T05:11:27.089476Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:11:27.089517Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:11:27.698488Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=305.739199ms elapsed_secs=0.305739199
2026-02-03T05:11:28.286997Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=281.162175ms elapsed_secs=0.281162175
2026-02-03T05:11:28.287682Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:11:28.287741Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:11:28.287885Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:11:28.287995Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:11:28.927138Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=338.949429ms elapsed_secs=0.338949429
2026-02-03T05:11:29.542665Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=335.747362ms elapsed_secs=0.335747362
2026-02-03T05:11:29.542904Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:11:29.543032Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:11:30.160128Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=350.253618ms elapsed_secs=0.350253618
2026-02-03T05:11:30.747785Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=294.83447ms elapsed_secs=0.29483447
2026-02-03T05:11:30.748416Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:11:30.748466Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:11:30.748588Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:11:30.748666Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:11:31.385072Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=347.668219ms elapsed_secs=0.347668219
2026-02-03T05:11:32.000094Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=308.456036ms elapsed_secs=0.308456036
2026-02-03T05:11:32.000324Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:11:56.435058Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:11:57.086951Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=307.394519ms elapsed_secs=0.307394519
2026-02-03T05:11:57.087953Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:11:57.088008Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:11:57.701314Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=317.223408ms elapsed_secs=0.317223408
2026-02-03T05:11:58.282869Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=274.603685ms elapsed_secs=0.274603685
2026-02-03T05:11:58.283585Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:11:58.283648Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:11:58.283849Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:11:58.283988Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:11:58.870260Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=292.210101ms elapsed_secs=0.292210101
2026-02-03T05:11:59.442055Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=295.753845ms elapsed_secs=0.295753845
2026-02-03T05:11:59.442300Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:11:59.442394Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:12:00.058685Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=308.113745ms elapsed_secs=0.308113745
2026-02-03T05:12:00.670960Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=306.994796ms elapsed_secs=0.306994796
2026-02-03T05:12:00.671641Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:12:00.671693Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:12:00.671800Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:12:00.671844Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:12:01.285943Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=308.083181ms elapsed_secs=0.308083181
2026-02-03T05:12:01.899375Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=307.110566ms elapsed_secs=0.307110566
2026-02-03T05:12:01.899591Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:12:26.435693Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:12:27.089897Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=306.991794ms elapsed_secs=0.306991794
2026-02-03T05:12:27.090829Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:12:27.090879Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:12:27.704363Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.419488ms elapsed_secs=0.307419488
2026-02-03T05:12:28.283717Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=272.503536ms elapsed_secs=0.272503536
2026-02-03T05:12:28.284385Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:12:28.284433Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:12:28.284601Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:12:28.284714Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:12:28.868571Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=295.088914ms elapsed_secs=0.295088914
2026-02-03T05:12:29.548790Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=308.38795ms elapsed_secs=0.30838795
2026-02-03T05:12:29.549006Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:12:29.549083Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:12:30.089900Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=273.58008ms elapsed_secs=0.27358008
2026-02-03T05:12:30.775404Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=306.504887ms elapsed_secs=0.306504887
2026-02-03T05:12:30.775995Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:12:30.776050Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:12:30.776178Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:12:30.776283Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:12:31.365662Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=282.125354ms elapsed_secs=0.282125354
2026-02-03T05:12:32.005000Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=322.218276ms elapsed_secs=0.322218276
2026-02-03T05:12:32.005198Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:12:56.435175Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:12:57.032461Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=296.951522ms elapsed_secs=0.296951522
2026-02-03T05:12:57.033387Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:12:57.033439Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:12:57.706891Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.574135ms elapsed_secs=0.307574135
2026-02-03T05:12:58.290054Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=276.518205ms elapsed_secs=0.276518205
2026-02-03T05:12:58.290456Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:12:58.290496Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:12:58.290615Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:12:58.290673Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:12:58.940747Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=312.003383ms elapsed_secs=0.312003383
2026-02-03T05:12:59.549630Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=307.189808ms elapsed_secs=0.307189808
2026-02-03T05:12:59.549836Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:12:59.549904Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:13:00.167425Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=310.622594ms elapsed_secs=0.310622594
2026-02-03T05:13:00.881013Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=409.77496ms elapsed_secs=0.40977496
2026-02-03T05:13:00.881672Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:13:00.881720Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:13:00.881841Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:13:00.881932Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:13:01.495252Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.179422ms elapsed_secs=0.307179422
2026-02-03T05:13:02.109782Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=307.339814ms elapsed_secs=0.307339814
2026-02-03T05:13:02.109905Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:13:26.434597Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:13:27.081003Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=293.334885ms elapsed_secs=0.293334885
2026-02-03T05:13:27.081730Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:13:27.081774Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:13:27.709661Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=356.401375ms elapsed_secs=0.356401375
2026-02-03T05:13:28.288678Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=272.173527ms elapsed_secs=0.272173527
2026-02-03T05:13:28.289038Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:13:28.289059Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:13:28.289136Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:13:28.289167Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:13:28.920681Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=289.482725ms elapsed_secs=0.289482725
2026-02-03T05:13:29.552369Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=307.566008ms elapsed_secs=0.307566008
2026-02-03T05:13:29.552618Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:13:29.552702Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:13:30.132443Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=272.948794ms elapsed_secs=0.272948794
2026-02-03T05:13:30.781220Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=306.862469ms elapsed_secs=0.306862469
2026-02-03T05:13:30.781888Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:13:30.781932Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:13:30.782030Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:13:30.782100Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:13:31.396207Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=315.312177ms elapsed_secs=0.315312177
2026-02-03T05:13:32.010316Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=307.532529ms elapsed_secs=0.307532529
2026-02-03T05:13:32.010533Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:13:56.029595Z  INFO ThreadId(01) vscu: src/main.rs:30: Starting VSCU middleware service
2026-02-03T05:13:56.030151Z  WARN ThreadId(01) sqlx_postgres::options::parse: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-postgres-0.8.6/src/options/parse.rs:107: ignoring unrecognized connect parameter key=channel_binding value=require
2026-02-03T05:13:58.312536Z  WARN ThreadId(01) sqlx::pool::acquire: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/pool/inner.rs:302: acquired connection, but time to acquire exceeded slow threshold aquired_after_secs=2.282191995 slow_acquire_threshold_secs=2.0
2026-02-03T05:13:58.313796Z  INFO ThreadId(01) vscu: src/main.rs:64: Server listening on 0.0.0.0:8000
2026-02-03T05:13:58.314235Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:13:58.680855Z  INFO ThreadId(02) vscu::product_management::items_save_items: src/product_management/items_save_items.rs:34: Bearer token received
2026-02-03T05:13:58.680933Z  INFO ThreadId(02) vscu::utils::bearer: src/utils/bearer.rs:11: MY TOKEN: "JOusKLDysCAmGrha6ftt87lkJkrZzupmOTrLH0fv2NiNCldRdmtSbMVTM5ro9l9l"
2026-02-03T05:13:59.248133Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=659.550282ms elapsed_secs=0.659550282
2026-02-03T05:13:59.248989Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:13:59.249041Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:14:01.023642Z  INFO ThreadId(09) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"credentials\".\"id\", \"credentials\".\"company_id\", \"credentials\".\"environment_name\", ‚Ä¶" db.statement="\n\nSELECT \"credentials\".\"id\", \"credentials\".\"company_id\", \"credentials\".\"environment_name\", \"credentials\".\"environment_url\", \"credentials\".\"pin\", \"credentials\".\"branch_id\", \"credentials\".\"device_serial\", \"credentials\".\"api_key\" FROM \"credentials\" WHERE \"credentials\".\"api_key\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=571.57206ms elapsed_secs=0.57157206
2026-02-03T05:14:02.324173Z  WARN ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:125: slow statement: execution time exceeded alert threshold summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=1.303942611s elapsed_secs=1.303942611 slow_threshold=1s
2026-02-03T05:14:02.934686Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="INSERT INTO \"item_master\" (\"tin\", ‚Ä¶" db.statement="\n\nINSERT INTO \"item_master\" (\"tin\", \"bhf_id\", \"status\", \"item_cd\", \"item_cls_cd\", \"item_ty_cd\", \"item_nm\", \"item_std_nm\", \"orgn_nat_cd\", \"pkg_unit_cd\", \"qty_unit_cd\", \"tax_ty_cd\", \"btch_no\", \"bcd\", \"dft_prc\", \"grp_prc_l1\", \"grp_prc_l2\", \"grp_prc_l3\", \"grp_prc_l4\", \"grp_prc_l5\", \"add_info\", \"sfty_qty\", \"isrc_aplcb_yn\", \"use_yn\", \"regr_nm\", \"regr_id\", \"modr_nm\", \"modr_id\") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22, $23, $24, $25, $26, $27, $28) RETURNING \"id\", \"tin\", \"bhf_id\", \"status\", \"item_cd\", \"item_cls_cd\", \"item_ty_cd\", \"item_nm\", \"item_std_nm\", \"orgn_nat_cd\", \"pkg_unit_cd\", \"qty_unit_cd\", \"tax_ty_cd\", \"btch_no\", \"bcd\", \"dft_prc\", \"grp_prc_l1\", \"grp_prc_l2\", \"grp_prc_l3\", \"grp_prc_l4\", \"grp_prc_l5\", \"add_info\", \"sfty_qty\", \"isrc_aplcb_yn\", \"use_yn\", \"regr_nm\", \"regr_id\", \"modr_nm\", \"modr_id\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=674.393946ms elapsed_secs=0.674393946
2026-02-03T05:14:03.241538Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="ROLLBACK" db.statement="" rows_affected=0 rows_returned=0 elapsed=306.5991ms elapsed_secs=0.3065991
2026-02-03T05:14:03.241579Z  INFO ThreadId(09) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=614.752939ms elapsed_secs=0.614752939
2026-02-03T05:14:03.241927Z ERROR ThreadId(13) tower_http::trace::on_failure: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tower-http-0.6.8/src/trace/on_failure.rs:93: response failed classification=Status code: 500 Internal Server Error latency=4561 ms
2026-02-03T05:14:03.242442Z  INFO ThreadId(09) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:14:03.242490Z  INFO ThreadId(09) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:14:03.242689Z  INFO ThreadId(09) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:14:03.242792Z ERROR ThreadId(09) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:14:03.792385Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=275.998322ms elapsed_secs=0.275998322
2026-02-03T05:14:04.470714Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=307.305588ms elapsed_secs=0.307305588
2026-02-03T05:14:04.470976Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:14:04.471048Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:14:05.301425Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=561.085322ms elapsed_secs=0.561085322
2026-02-03T05:14:06.185507Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=588.296528ms elapsed_secs=0.588296528
2026-02-03T05:14:06.186147Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:14:06.186186Z  INFO ThreadId(02) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:14:06.186299Z  INFO ThreadId(02) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:14:06.186371Z ERROR ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:14:07.134678Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=616.11524ms elapsed_secs=0.61611524
2026-02-03T05:14:07.747512Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=307.204203ms elapsed_secs=0.307204203
2026-02-03T05:14:07.747802Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:14:28.313895Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:14:29.251276Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=667.203187ms elapsed_secs=0.667203187
2026-02-03T05:14:29.251959Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:14:29.251981Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:14:29.865493Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.441404ms elapsed_secs=0.307441404
2026-02-03T05:14:30.479472Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=306.793959ms elapsed_secs=0.306793959
2026-02-03T05:14:30.480104Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:14:30.480140Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:14:30.480237Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:14:30.480307Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:14:31.086150Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=299.579182ms elapsed_secs=0.299579182
2026-02-03T05:14:31.685509Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=284.387845ms elapsed_secs=0.284387845
2026-02-03T05:14:31.685735Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:14:31.685816Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:14:32.225486Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=273.210366ms elapsed_secs=0.273210366
2026-02-03T05:14:32.794252Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=273.73899ms elapsed_secs=0.27373899
2026-02-03T05:14:32.794980Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:14:32.795033Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:14:32.795175Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:14:32.795320Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:14:33.449413Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.554162ms elapsed_secs=0.307554162
2026-02-03T05:14:34.063169Z  INFO ThreadId(09) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=306.922767ms elapsed_secs=0.306922767
2026-02-03T05:14:34.063359Z ERROR ThreadId(09) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:14:58.313901Z  INFO ThreadId(09) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:14:58.946304Z  INFO ThreadId(09) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=314.136651ms elapsed_secs=0.314136651
2026-02-03T05:14:58.946917Z  INFO ThreadId(09) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:14:58.946938Z  INFO ThreadId(09) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:14:59.560805Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.454053ms elapsed_secs=0.307454053
2026-02-03T05:15:00.175186Z  INFO ThreadId(09) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=307.098245ms elapsed_secs=0.307098245
2026-02-03T05:15:00.175788Z  INFO ThreadId(09) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:15:00.175831Z  INFO ThreadId(09) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:15:00.175929Z  INFO ThreadId(09) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:15:00.175965Z ERROR ThreadId(09) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:15:00.789886Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.186522ms elapsed_secs=0.307186522
2026-02-03T05:15:01.404640Z  INFO ThreadId(09) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=307.650043ms elapsed_secs=0.307650043
2026-02-03T05:15:01.404898Z ERROR ThreadId(09) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:15:01.404970Z  INFO ThreadId(09) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:15:02.019654Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=308.365468ms elapsed_secs=0.308365468
2026-02-03T05:15:02.633027Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=307.319034ms elapsed_secs=0.307319034
2026-02-03T05:15:02.633808Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:15:02.633850Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:15:02.633975Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:15:02.634047Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:15:03.247313Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.563394ms elapsed_secs=0.307563394
2026-02-03T05:15:03.861438Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=306.762229ms elapsed_secs=0.306762229
2026-02-03T05:15:03.861722Z ERROR ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:15:28.313772Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:15:28.931302Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=288.381914ms elapsed_secs=0.288381914
2026-02-03T05:15:28.932208Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:15:28.932240Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:15:29.563511Z  INFO ThreadId(09) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.479955ms elapsed_secs=0.307479955
2026-02-03T05:15:30.142776Z  INFO ThreadId(09) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=272.059079ms elapsed_secs=0.272059079
2026-02-03T05:15:30.143358Z  INFO ThreadId(09) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:15:30.143401Z  INFO ThreadId(09) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:15:30.143485Z  INFO ThreadId(09) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:15:30.143522Z ERROR ThreadId(09) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:15:30.792105Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=306.759382ms elapsed_secs=0.306759382
2026-02-03T05:15:31.406363Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=307.081449ms elapsed_secs=0.307081449
2026-02-03T05:15:31.406630Z ERROR ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:15:31.406735Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:15:32.021363Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.756957ms elapsed_secs=0.307756957
2026-02-03T05:15:32.604387Z  INFO ThreadId(02) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=276.375219ms elapsed_secs=0.276375219
2026-02-03T05:15:32.605068Z  INFO ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:15:32.605117Z  INFO ThreadId(02) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:15:32.605184Z  INFO ThreadId(02) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:15:32.605225Z ERROR ThreadId(02) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:15:33.250363Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.987613ms elapsed_secs=0.307987613
2026-02-03T05:15:33.864221Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=307.094977ms elapsed_secs=0.307094977
2026-02-03T05:15:33.864586Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:21:27.797242Z  INFO ThreadId(01) vscu: src/main.rs:30: Starting VSCU middleware service
2026-02-03T05:21:27.797759Z  WARN ThreadId(01) sqlx_postgres::options::parse: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-postgres-0.8.6/src/options/parse.rs:107: ignoring unrecognized connect parameter key=channel_binding value=require
2026-02-03T05:21:29.699504Z  INFO ThreadId(01) vscu: src/main.rs:64: Server listening on 0.0.0.0:8000
2026-02-03T05:21:29.699726Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:21:30.621027Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=614.240564ms elapsed_secs=0.614240564
2026-02-03T05:21:30.621932Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:21:30.621997Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:21:32.220151Z  INFO ThreadId(12) vscu::product_management::items_save_items: src/product_management/items_save_items.rs:34: Bearer token received
2026-02-03T05:21:32.220223Z  INFO ThreadId(12) vscu::utils::bearer: src/utils/bearer.rs:11: MY TOKEN: "JOusKLDysCAmGrha6ftt87lkJkrZzupmOTrLH0fv2NiNCldRdmtSbMVTM5ro9l9l"
2026-02-03T05:21:33.042158Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"credentials\".\"id\", \"credentials\".\"company_id\", \"credentials\".\"environment_name\", ‚Ä¶" db.statement="\n\nSELECT \"credentials\".\"id\", \"credentials\".\"company_id\", \"credentials\".\"environment_name\", \"credentials\".\"environment_url\", \"credentials\".\"pin\", \"credentials\".\"branch_id\", \"credentials\".\"device_serial\", \"credentials\".\"api_key\" FROM \"credentials\" WHERE \"credentials\".\"api_key\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=553.355945ms elapsed_secs=0.553355945
2026-02-03T05:21:33.074076Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=579.8945ms elapsed_secs=0.5798945
2026-02-03T05:21:35.637820Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=611.988479ms elapsed_secs=0.611988479
2026-02-03T05:21:35.638108Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:21:35.638134Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:21:35.638217Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:21:35.638294Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:21:35.945482Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="INSERT INTO \"item_master\" (\"tin\", ‚Ä¶" db.statement="\n\nINSERT INTO \"item_master\" (\"tin\", \"bhf_id\", \"status\", \"item_cd\", \"item_cls_cd\", \"item_ty_cd\", \"item_nm\", \"item_std_nm\", \"orgn_nat_cd\", \"pkg_unit_cd\", \"qty_unit_cd\", \"tax_ty_cd\", \"btch_no\", \"bcd\", \"dft_prc\", \"grp_prc_l1\", \"grp_prc_l2\", \"grp_prc_l3\", \"grp_prc_l4\", \"grp_prc_l5\", \"add_info\", \"sfty_qty\", \"isrc_aplcb_yn\", \"use_yn\", \"regr_nm\", \"regr_id\", \"modr_nm\", \"modr_id\") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22, $23, $24, $25, $26, $27, $28) RETURNING \"id\", \"tin\", \"bhf_id\", \"status\", \"item_cd\", \"item_cls_cd\", \"item_ty_cd\", \"item_nm\", \"item_std_nm\", \"orgn_nat_cd\", \"pkg_unit_cd\", \"qty_unit_cd\", \"tax_ty_cd\", \"btch_no\", \"bcd\", \"dft_prc\", \"grp_prc_l1\", \"grp_prc_l2\", \"grp_prc_l3\", \"grp_prc_l4\", \"grp_prc_l5\", \"add_info\", \"sfty_qty\", \"isrc_aplcb_yn\", \"use_yn\", \"regr_nm\", \"regr_id\", \"modr_nm\", \"modr_id\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=614.189946ms elapsed_secs=0.614189946
2026-02-03T05:21:35.945876Z  INFO ThreadId(10) vscu::product_management::items_save_items: src/product_management/items_save_items.rs:112: Inserted item with ID: 15
2026-02-03T05:21:36.253348Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="COMMIT" db.statement="" rows_affected=0 rows_returned=0 elapsed=307.359751ms elapsed_secs=0.307359751
2026-02-03T05:21:36.253503Z  INFO ThreadId(12) vscu::product_management::items_save_items: src/product_management/items_save_items.rs:127: Transaction committed successfully. 1 items inserted.
2026-02-03T05:21:36.560780Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=615.469843ms elapsed_secs=0.615469843
2026-02-03T05:21:37.276483Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"item_master\".\"id\", \"item_master\".\"tin\", \"item_master\".\"bhf_id\", ‚Ä¶" db.statement="\n\nSELECT \"item_master\".\"id\", \"item_master\".\"tin\", \"item_master\".\"bhf_id\", \"item_master\".\"status\", \"item_master\".\"item_cd\", \"item_master\".\"item_cls_cd\", \"item_master\".\"item_ty_cd\", \"item_master\".\"item_nm\", \"item_master\".\"item_std_nm\", \"item_master\".\"orgn_nat_cd\", \"item_master\".\"pkg_unit_cd\", \"item_master\".\"qty_unit_cd\", \"item_master\".\"tax_ty_cd\", \"item_master\".\"btch_no\", \"item_master\".\"bcd\", \"item_master\".\"dft_prc\", \"item_master\".\"grp_prc_l1\", \"item_master\".\"grp_prc_l2\", \"item_master\".\"grp_prc_l3\", \"item_master\".\"grp_prc_l4\", \"item_master\".\"grp_prc_l5\", \"item_master\".\"add_info\", \"item_master\".\"sfty_qty\", \"item_master\".\"isrc_aplcb_yn\", \"item_master\".\"use_yn\", \"item_master\".\"regr_nm\", \"item_master\".\"regr_id\", \"item_master\".\"modr_nm\", \"item_master\".\"modr_id\", \"item_master\".\"response\" FROM \"item_master\" WHERE \"item_master\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=715.76973ms elapsed_secs=0.71576973
2026-02-03T05:21:37.276877Z  INFO ThreadId(10) vscu::product_management::items_save_items: src/product_management/items_save_items.rs:161: Processing record ID: 15
2026-02-03T05:21:37.277610Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=410.201836ms elapsed_secs=0.410201836
2026-02-03T05:21:37.277752Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:21:37.277843Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:21:37.891120Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=306.805089ms elapsed_secs=0.306805089
2026-02-03T05:21:38.198483Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"item_master\".\"id\", \"item_master\".\"tin\", \"item_master\".\"bhf_id\", ‚Ä¶" db.statement="\n\nSELECT \"item_master\".\"id\", \"item_master\".\"tin\", \"item_master\".\"bhf_id\", \"item_master\".\"status\", \"item_master\".\"item_cd\", \"item_master\".\"item_cls_cd\", \"item_master\".\"item_ty_cd\", \"item_master\".\"item_nm\", \"item_master\".\"item_std_nm\", \"item_master\".\"orgn_nat_cd\", \"item_master\".\"pkg_unit_cd\", \"item_master\".\"qty_unit_cd\", \"item_master\".\"tax_ty_cd\", \"item_master\".\"btch_no\", \"item_master\".\"bcd\", \"item_master\".\"dft_prc\", \"item_master\".\"grp_prc_l1\", \"item_master\".\"grp_prc_l2\", \"item_master\".\"grp_prc_l3\", \"item_master\".\"grp_prc_l4\", \"item_master\".\"grp_prc_l5\", \"item_master\".\"add_info\", \"item_master\".\"sfty_qty\", \"item_master\".\"isrc_aplcb_yn\", \"item_master\".\"use_yn\", \"item_master\".\"regr_nm\", \"item_master\".\"regr_id\", \"item_master\".\"modr_nm\", \"item_master\".\"modr_id\", \"item_master\".\"response\" FROM \"item_master\" WHERE \"item_master\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=614.576856ms elapsed_secs=0.614576856
2026-02-03T05:21:38.812881Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=614.506595ms elapsed_secs=0.614506595
2026-02-03T05:21:38.813313Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:21:38.813343Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:21:38.813431Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:21:38.813470Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:21:39.120181Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"item_master\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"item_master\" SET \"status\" = $1 WHERE \"item_master\".\"id\" = $2 RETURNING \"id\", \"tin\", \"bhf_id\", \"status\", \"item_cd\", \"item_cls_cd\", \"item_ty_cd\", \"item_nm\", \"item_std_nm\", \"orgn_nat_cd\", \"pkg_unit_cd\", \"qty_unit_cd\", \"tax_ty_cd\", \"btch_no\", \"bcd\", \"dft_prc\", \"grp_prc_l1\", \"grp_prc_l2\", \"grp_prc_l3\", \"grp_prc_l4\", \"grp_prc_l5\", \"add_info\", \"sfty_qty\", \"isrc_aplcb_yn\", \"use_yn\", \"regr_nm\", \"regr_id\", \"modr_nm\", \"modr_id\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=630.722691ms elapsed_secs=0.630722691
2026-02-03T05:21:39.120644Z  INFO ThreadId(13) vscu::product_management::items_save_items: src/product_management/items_save_items.rs:305: Updated record 15 status to PROCESSING
2026-02-03T05:21:39.120684Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:21:39.120811Z  INFO ThreadId(13) vscu::product_management::items_save_items: src/product_management/items_save_items.rs:183: Decrypt tin OK for record 15
2026-02-03T05:21:39.428115Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=308.208729ms elapsed_secs=0.308208729
2026-02-03T05:21:40.041269Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=306.803749ms elapsed_secs=0.306803749
2026-02-03T05:21:40.041517Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:21:42.276962Z ERROR ThreadId(12) vscu::product_management::items_save_items: src/product_management/items_save_items.rs:280: Failed to send to KRA endpoint for record 15: error sending request for url (http://192.168.1.71:8088/items/saveItems)
2026-02-03T05:21:42.908505Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"item_master\".\"id\", \"item_master\".\"tin\", \"item_master\".\"bhf_id\", ‚Ä¶" db.statement="\n\nSELECT \"item_master\".\"id\", \"item_master\".\"tin\", \"item_master\".\"bhf_id\", \"item_master\".\"status\", \"item_master\".\"item_cd\", \"item_master\".\"item_cls_cd\", \"item_master\".\"item_ty_cd\", \"item_master\".\"item_nm\", \"item_master\".\"item_std_nm\", \"item_master\".\"orgn_nat_cd\", \"item_master\".\"pkg_unit_cd\", \"item_master\".\"qty_unit_cd\", \"item_master\".\"tax_ty_cd\", \"item_master\".\"btch_no\", \"item_master\".\"bcd\", \"item_master\".\"dft_prc\", \"item_master\".\"grp_prc_l1\", \"item_master\".\"grp_prc_l2\", \"item_master\".\"grp_prc_l3\", \"item_master\".\"grp_prc_l4\", \"item_master\".\"grp_prc_l5\", \"item_master\".\"add_info\", \"item_master\".\"sfty_qty\", \"item_master\".\"isrc_aplcb_yn\", \"item_master\".\"use_yn\", \"item_master\".\"regr_nm\", \"item_master\".\"regr_id\", \"item_master\".\"modr_nm\", \"item_master\".\"modr_id\", \"item_master\".\"response\" FROM \"item_master\" WHERE \"item_master\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=306.730854ms elapsed_secs=0.306730854
2026-02-03T05:21:43.522417Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"item_master\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"item_master\" SET \"status\" = $1 WHERE \"item_master\".\"id\" = $2 RETURNING \"id\", \"tin\", \"bhf_id\", \"status\", \"item_cd\", \"item_cls_cd\", \"item_ty_cd\", \"item_nm\", \"item_std_nm\", \"orgn_nat_cd\", \"pkg_unit_cd\", \"qty_unit_cd\", \"tax_ty_cd\", \"btch_no\", \"bcd\", \"dft_prc\", \"grp_prc_l1\", \"grp_prc_l2\", \"grp_prc_l3\", \"grp_prc_l4\", \"grp_prc_l5\", \"add_info\", \"sfty_qty\", \"isrc_aplcb_yn\", \"use_yn\", \"regr_nm\", \"regr_id\", \"modr_nm\", \"modr_id\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=329.636171ms elapsed_secs=0.329636171
2026-02-03T05:21:43.522897Z ERROR ThreadId(11) vscu::product_management::items_save_items: src/product_management/items_save_items.rs:349: Marked record 15 as FAILED with retry count 0
2026-02-03T05:21:43.523142Z  INFO ThreadId(11) vscu::product_management::items_save_items: src/product_management/items_save_items.rs:286: Completed KRA submission processing for all items
2026-02-03T05:21:59.700246Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:22:00.316415Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=307.37139ms elapsed_secs=0.30737139
2026-02-03T05:22:00.317154Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:22:00.317200Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:22:01.237968Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=649.589318ms elapsed_secs=0.649589318
2026-02-03T05:22:01.852429Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=307.240424ms elapsed_secs=0.307240424
2026-02-03T05:22:01.853141Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:22:01.853168Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:22:01.853262Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:22:01.853298Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:22:02.876637Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=717.449266ms elapsed_secs=0.717449266
2026-02-03T05:22:03.490712Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=307.005083ms elapsed_secs=0.307005083
2026-02-03T05:22:03.491016Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:22:03.491095Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:22:04.104631Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.153742ms elapsed_secs=0.307153742
2026-02-03T05:22:04.719112Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=306.725677ms elapsed_secs=0.306725677
2026-02-03T05:22:04.719808Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:22:04.719847Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:22:04.719946Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:22:04.720017Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:22:05.333824Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.394576ms elapsed_secs=0.307394576
2026-02-03T05:22:05.924287Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=283.111458ms elapsed_secs=0.283111458
2026-02-03T05:22:05.924501Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:22:29.700432Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:22:30.626305Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=614.211879ms elapsed_secs=0.614211879
2026-02-03T05:22:30.627204Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:22:30.627254Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:22:31.240297Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=306.410272ms elapsed_secs=0.306410272
2026-02-03T05:22:31.958321Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=409.565316ms elapsed_secs=0.409565316
2026-02-03T05:22:31.958889Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:22:31.958917Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:22:31.959010Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:22:31.959044Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:22:32.571929Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.383482ms elapsed_secs=0.307383482
2026-02-03T05:22:33.185948Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=307.012806ms elapsed_secs=0.307012806
2026-02-03T05:22:33.186181Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:22:33.186246Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:22:33.800965Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.471918ms elapsed_secs=0.307471918
2026-02-03T05:22:34.414843Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=307.198976ms elapsed_secs=0.307198976
2026-02-03T05:22:34.415470Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:22:34.415516Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:22:34.415657Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:22:34.415750Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:22:35.029147Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.045728ms elapsed_secs=0.307045728
2026-02-03T05:22:35.643405Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=307.263408ms elapsed_secs=0.307263408
2026-02-03T05:22:35.643641Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:22:59.699998Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:23:00.607998Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=593.822521ms elapsed_secs=0.593822521
2026-02-03T05:23:00.608710Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:23:00.608744Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:23:01.243135Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.263634ms elapsed_secs=0.307263634
2026-02-03T05:23:02.166476Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=616.107057ms elapsed_secs=0.616107057
2026-02-03T05:23:02.167150Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:23:02.167170Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:23:02.167234Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:23:02.167263Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:23:02.779722Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.396314ms elapsed_secs=0.307396314
2026-02-03T05:23:03.393949Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=307.088324ms elapsed_secs=0.307088324
2026-02-03T05:23:03.394271Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:23:03.394405Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:23:04.008311Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=306.994559ms elapsed_secs=0.306994559
2026-02-03T05:23:04.585629Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=268.926149ms elapsed_secs=0.268926149
2026-02-03T05:23:04.586196Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:23:04.586249Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:23:04.586378Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:23:04.586517Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:23:05.237202Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.557878ms elapsed_secs=0.307557878
2026-02-03T05:23:05.851087Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=307.167115ms elapsed_secs=0.307167115
2026-02-03T05:23:05.851257Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:23:29.699865Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:23:30.837189Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=819.521398ms elapsed_secs=0.819521398
2026-02-03T05:23:30.837960Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:23:30.838015Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:23:31.451239Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.249124ms elapsed_secs=0.307249124
2026-02-03T05:23:32.372937Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=614.954914ms elapsed_secs=0.614954914
2026-02-03T05:23:32.373593Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:23:32.373634Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:23:32.373768Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:23:32.373864Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:23:32.987229Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=306.499244ms elapsed_secs=0.306499244
2026-02-03T05:23:33.703924Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=414.280205ms elapsed_secs=0.414280205
2026-02-03T05:23:33.704251Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:23:33.704390Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:23:34.320014Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=308.548998ms elapsed_secs=0.308548998
2026-02-03T05:23:34.934240Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=309.058015ms elapsed_secs=0.309058015
2026-02-03T05:23:34.935401Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:23:34.935452Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:23:34.935604Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:23:34.935688Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:23:35.546813Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.068466ms elapsed_secs=0.307068466
2026-02-03T05:23:36.366002Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=409.437095ms elapsed_secs=0.409437095
2026-02-03T05:23:36.366225Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:23:59.699930Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:24:00.327763Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=307.670448ms elapsed_secs=0.307670448
2026-02-03T05:24:00.328458Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:24:00.328506Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:24:00.905175Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=270.459614ms elapsed_secs=0.270459614
2026-02-03T05:24:01.557322Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=365.385166ms elapsed_secs=0.365385166
2026-02-03T05:24:01.557838Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:24:01.557876Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:24:01.557994Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:24:01.558091Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:24:02.151969Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=289.209455ms elapsed_secs=0.289209455
2026-02-03T05:24:02.784900Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=301.003844ms elapsed_secs=0.301003844
2026-02-03T05:24:02.785118Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:24:02.785189Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:24:03.399767Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.55674ms elapsed_secs=0.30755674
2026-02-03T05:24:04.013674Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=306.783256ms elapsed_secs=0.306783256
2026-02-03T05:24:04.014212Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:24:04.014248Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:24:04.014368Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:24:04.014480Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:24:04.628177Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.140576ms elapsed_secs=0.307140576
2026-02-03T05:24:05.242476Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=307.157002ms elapsed_secs=0.307157002
2026-02-03T05:24:05.242741Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:24:29.699897Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:24:30.305283Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=281.848402ms elapsed_secs=0.281848402
2026-02-03T05:24:30.306300Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:24:30.306407Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:24:30.945511Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=360.221791ms elapsed_secs=0.360221791
2026-02-03T05:24:31.560079Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=307.517656ms elapsed_secs=0.307517656
2026-02-03T05:24:31.560835Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:24:31.560890Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:24:31.561003Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:24:31.561074Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:24:32.141595Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=275.025181ms elapsed_secs=0.275025181
2026-02-03T05:24:32.788105Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=307.361664ms elapsed_secs=0.307361664
2026-02-03T05:24:32.788461Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:24:32.788584Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:24:33.403740Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=308.38763ms elapsed_secs=0.30838763
2026-02-03T05:24:34.017235Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=320.55459ms elapsed_secs=0.32055459
2026-02-03T05:24:34.017895Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:24:34.017938Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:24:34.018063Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:24:34.018170Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:24:34.632868Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=308.802148ms elapsed_secs=0.308802148
2026-02-03T05:24:35.246203Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=336.857942ms elapsed_secs=0.336857942
2026-02-03T05:24:35.246374Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:24:59.700102Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:25:00.312801Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=286.220571ms elapsed_secs=0.286220571
2026-02-03T05:25:00.313522Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:25:00.313588Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:25:00.948516Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=306.673962ms elapsed_secs=0.306673962
2026-02-03T05:25:01.562615Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=307.857727ms elapsed_secs=0.307857727
2026-02-03T05:25:01.563194Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:25:01.563234Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:25:01.563332Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:25:01.563402Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:25:02.177316Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.385559ms elapsed_secs=0.307385559
2026-02-03T05:25:02.893862Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=409.584044ms elapsed_secs=0.409584044
2026-02-03T05:25:02.894149Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:25:02.894239Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:25:03.509100Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=308.236671ms elapsed_secs=0.308236671
2026-02-03T05:25:04.122514Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=307.237377ms elapsed_secs=0.307237377
2026-02-03T05:25:04.123162Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:25:04.123212Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:25:04.123329Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:25:04.123420Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:25:04.736706Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=306.927626ms elapsed_secs=0.306927626
2026-02-03T05:25:05.352252Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=307.090369ms elapsed_secs=0.307090369
2026-02-03T05:25:05.352478Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:25:29.700118Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:25:30.332508Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=302.634615ms elapsed_secs=0.302634615
2026-02-03T05:25:30.333491Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:25:30.333565Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:25:30.950987Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=345.948607ms elapsed_secs=0.345948607
2026-02-03T05:25:31.489582Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=268.311823ms elapsed_secs=0.268311823
2026-02-03T05:25:31.490215Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:25:31.490261Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:25:31.490393Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:25:31.490486Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:25:32.053707Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=283.913537ms elapsed_secs=0.283913537
2026-02-03T05:25:32.691684Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=342.549742ms elapsed_secs=0.342549742
2026-02-03T05:25:32.691930Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:25:32.692025Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:25:33.307919Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=308.663116ms elapsed_secs=0.308663116
2026-02-03T05:25:33.921566Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=344.329754ms elapsed_secs=0.344329754
2026-02-03T05:25:33.922189Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:25:33.922235Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:25:33.922355Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:25:33.922447Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:25:34.535517Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=306.531155ms elapsed_secs=0.306531155
2026-02-03T05:25:35.150888Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=325.950102ms elapsed_secs=0.325950102
2026-02-03T05:25:35.151120Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:25:59.700717Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:26:00.340345Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=307.223296ms elapsed_secs=0.307223296
2026-02-03T05:26:00.341338Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:26:00.341397Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:26:00.956183Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.148997ms elapsed_secs=0.307148997
2026-02-03T05:26:01.569198Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=306.347605ms elapsed_secs=0.306347605
2026-02-03T05:26:01.569998Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:26:01.570062Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:26:01.570201Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:26:01.570291Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:26:02.167862Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=291.822441ms elapsed_secs=0.291822441
2026-02-03T05:26:02.797856Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=350.416895ms elapsed_secs=0.350416895
2026-02-03T05:26:02.798200Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:26:02.798289Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:26:03.413124Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.777719ms elapsed_secs=0.307777719
2026-02-03T05:26:04.029241Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=309.394598ms elapsed_secs=0.309394598
2026-02-03T05:26:04.030056Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:26:04.030108Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:26:04.030256Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:26:04.030349Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:26:04.641091Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=306.916745ms elapsed_secs=0.306916745
2026-02-03T05:26:05.255595Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=307.198443ms elapsed_secs=0.307198443
2026-02-03T05:26:05.255816Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:26:29.700318Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:26:30.345861Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=309.757609ms elapsed_secs=0.309757609
2026-02-03T05:26:30.346824Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:26:30.346858Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:26:30.958915Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=326.562834ms elapsed_secs=0.326562834
2026-02-03T05:26:31.778670Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=410.881731ms elapsed_secs=0.410881731
2026-02-03T05:26:31.779311Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:26:31.779359Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:26:31.779469Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:26:31.779502Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:26:32.391328Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=315.097617ms elapsed_secs=0.315097617
2026-02-03T05:26:33.005669Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=307.292524ms elapsed_secs=0.307292524
2026-02-03T05:26:33.005895Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:26:33.005962Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:26:33.620196Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.267451ms elapsed_secs=0.307267451
2026-02-03T05:26:34.336896Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=409.165565ms elapsed_secs=0.409165565
2026-02-03T05:26:34.337526Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:26:34.337593Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:26:34.337716Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:26:34.337807Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:26:34.951687Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.652374ms elapsed_secs=0.307652374
2026-02-03T05:26:35.565637Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=306.868978ms elapsed_secs=0.306868978
2026-02-03T05:26:35.565806Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:26:59.699977Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:27:00.347171Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=306.617255ms elapsed_secs=0.306617255
2026-02-03T05:27:00.348143Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:27:00.348195Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:27:01.166080Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=409.659889ms elapsed_secs=0.409659889
2026-02-03T05:27:01.779995Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=307.157992ms elapsed_secs=0.307157992
2026-02-03T05:27:01.780587Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:27:01.780632Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:27:01.780731Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:27:01.780802Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:27:02.394160Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=306.254369ms elapsed_secs=0.306254369
2026-02-03T05:27:03.008709Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=312.558599ms elapsed_secs=0.312558599
2026-02-03T05:27:03.008924Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:27:03.008996Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:27:03.725880Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=409.884486ms elapsed_secs=0.409884486
2026-02-03T05:27:04.340400Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=307.183666ms elapsed_secs=0.307183666
2026-02-03T05:27:04.340927Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:27:04.340967Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:27:04.341068Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:27:04.341139Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:27:04.932344Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=284.541092ms elapsed_secs=0.284541092
2026-02-03T05:27:05.569212Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=307.255147ms elapsed_secs=0.307255147
2026-02-03T05:27:05.569496Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:27:29.700253Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:27:30.452094Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=409.798262ms elapsed_secs=0.409798262
2026-02-03T05:27:30.453063Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:27:30.453122Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:27:31.066438Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.478718ms elapsed_secs=0.307478718
2026-02-03T05:27:31.680872Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=307.183878ms elapsed_secs=0.307183878
2026-02-03T05:27:31.681493Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:27:31.681573Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:27:31.681698Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:27:31.681789Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:27:32.398149Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=404.178204ms elapsed_secs=0.404178204
2026-02-03T05:27:33.216601Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=409.07109ms elapsed_secs=0.40907109
2026-02-03T05:27:33.216816Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:27:33.216917Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:27:33.812923Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=288.478126ms elapsed_secs=0.288478126
2026-02-03T05:27:34.446135Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=329.250437ms elapsed_secs=0.329250437
2026-02-03T05:27:34.446819Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:27:34.446863Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:27:34.446987Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:27:34.447119Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:27:35.061627Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=308.763638ms elapsed_secs=0.308763638
2026-02-03T05:27:35.879024Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=409.075112ms elapsed_secs=0.409075112
2026-02-03T05:27:35.879268Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:27:59.700785Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:28:00.353305Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=307.819187ms elapsed_secs=0.307819187
2026-02-03T05:28:00.354046Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:28:00.354083Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:28:00.967483Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.373063ms elapsed_secs=0.307373063
2026-02-03T05:28:01.786812Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=409.666774ms elapsed_secs=0.409666774
2026-02-03T05:28:01.787354Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:28:01.787387Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:28:01.787481Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:28:01.787518Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:28:02.503259Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=414.007413ms elapsed_secs=0.414007413
2026-02-03T05:28:03.117818Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=307.145543ms elapsed_secs=0.307145543
2026-02-03T05:28:03.118075Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:28:03.118150Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:28:03.731710Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.119561ms elapsed_secs=0.307119561
2026-02-03T05:28:04.449041Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=409.184255ms elapsed_secs=0.409184255
2026-02-03T05:28:04.449741Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:28:04.449790Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:28:04.449891Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:28:04.449962Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:28:05.167294Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=410.454755ms elapsed_secs=0.410454755
2026-02-03T05:28:05.882092Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=409.463718ms elapsed_secs=0.409463718
2026-02-03T05:28:05.882262Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:28:29.701731Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:28:30.356646Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=307.634278ms elapsed_secs=0.307634278
2026-02-03T05:28:30.357572Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:28:30.357612Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:28:30.971425Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.969271ms elapsed_secs=0.307969271
2026-02-03T05:28:31.790030Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=409.761694ms elapsed_secs=0.409761694
2026-02-03T05:28:31.790694Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:28:31.790739Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:28:31.790873Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:28:31.790976Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:28:32.404062Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=335.22792ms elapsed_secs=0.33522792
2026-02-03T05:28:33.018533Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=307.419684ms elapsed_secs=0.307419684
2026-02-03T05:28:33.018881Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:28:33.018969Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:28:33.636272Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=310.421862ms elapsed_secs=0.310421862
2026-02-03T05:28:34.247386Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=307.503465ms elapsed_secs=0.307503465
2026-02-03T05:28:34.247998Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:28:34.248037Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:28:34.248137Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:28:34.248224Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:28:34.861969Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.435405ms elapsed_secs=0.307435405
2026-02-03T05:28:35.476185Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=307.343079ms elapsed_secs=0.307343079
2026-02-03T05:28:35.476442Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:28:59.700413Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:29:00.358033Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=308.390796ms elapsed_secs=0.308390796
2026-02-03T05:29:00.358981Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:29:00.359027Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:29:00.974151Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.414792ms elapsed_secs=0.307414792
2026-02-03T05:29:01.588194Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=307.35233ms elapsed_secs=0.30735233
2026-02-03T05:29:01.588887Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:29:01.588928Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:29:01.589054Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:29:01.589129Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:29:02.202435Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.633298ms elapsed_secs=0.307633298
2026-02-03T05:29:02.789476Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=299.84854ms elapsed_secs=0.29984854
2026-02-03T05:29:02.789794Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:29:02.789887Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:29:03.431210Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.643372ms elapsed_secs=0.307643372
2026-02-03T05:29:04.045445Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=306.910689ms elapsed_secs=0.306910689
2026-02-03T05:29:04.046127Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:29:04.046169Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:29:04.046293Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:29:04.046367Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:29:04.660111Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.291273ms elapsed_secs=0.307291273
2026-02-03T05:29:05.274043Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=306.846991ms elapsed_secs=0.306846991
2026-02-03T05:29:05.274297Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:29:29.699768Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:29:30.362252Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=307.516931ms elapsed_secs=0.307516931
2026-02-03T05:29:30.363255Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:29:30.363303Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:29:30.976618Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.301915ms elapsed_secs=0.307301915
2026-02-03T05:29:31.590788Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=307.112153ms elapsed_secs=0.307112153
2026-02-03T05:29:31.591282Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:29:31.591321Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:29:31.591417Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:29:31.591489Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:29:32.184830Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=286.449983ms elapsed_secs=0.286449983
2026-02-03T05:29:32.921858Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=409.059619ms elapsed_secs=0.409059619
2026-02-03T05:29:32.922069Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:29:32.922137Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:29:33.536496Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=347.818512ms elapsed_secs=0.347818512
2026-02-03T05:29:34.152605Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=308.848723ms elapsed_secs=0.308848723
2026-02-03T05:29:34.153349Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:29:34.153397Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:29:34.153528Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:29:34.153648Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:29:34.745717Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=287.197557ms elapsed_secs=0.287197557
2026-02-03T05:29:35.379391Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=306.840735ms elapsed_secs=0.306840735
2026-02-03T05:29:35.379630Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:29:59.699922Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:30:00.363118Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=304.881756ms elapsed_secs=0.304881756
2026-02-03T05:30:00.363965Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:30:00.363999Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:30:00.980300Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.421023ms elapsed_secs=0.307421023
2026-02-03T05:30:01.594297Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=307.18829ms elapsed_secs=0.30718829
2026-02-03T05:30:01.595125Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:30:01.595190Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:30:01.595358Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:30:01.595458Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:30:02.208706Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.215167ms elapsed_secs=0.307215167
2026-02-03T05:30:02.823869Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=342.624815ms elapsed_secs=0.342624815
2026-02-03T05:30:02.824125Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:30:02.824197Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:30:03.437903Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.630866ms elapsed_secs=0.307630866
2026-02-03T05:30:04.051860Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=307.107729ms elapsed_secs=0.307107729
2026-02-03T05:30:04.052559Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:30:04.052616Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:30:04.052747Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:30:04.052838Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:30:04.666838Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.840721ms elapsed_secs=0.307840721
2026-02-03T05:30:05.279879Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=306.482162ms elapsed_secs=0.306482162
2026-02-03T05:30:05.279999Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:30:29.700224Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:30:30.368751Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=307.440888ms elapsed_secs=0.307440888
2026-02-03T05:30:30.369823Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:30:30.369876Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:30:30.984122Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.822708ms elapsed_secs=0.307822708
2026-02-03T05:30:31.591042Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=300.866372ms elapsed_secs=0.300866372
2026-02-03T05:30:31.591509Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:30:31.591538Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:30:31.591643Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:30:31.591680Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:30:32.150863Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=282.868196ms elapsed_secs=0.282868196
2026-02-03T05:30:32.723705Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=296.218491ms elapsed_secs=0.296218491
2026-02-03T05:30:32.723993Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:30:32.724078Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:30:33.338244Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.181627ms elapsed_secs=0.307181627
2026-02-03T05:30:33.953358Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=308.381374ms elapsed_secs=0.308381374
2026-02-03T05:30:33.954118Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:30:33.954187Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:30:33.954354Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:30:33.954526Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:30:34.566970Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.515326ms elapsed_secs=0.307515326
2026-02-03T05:30:35.181039Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=307.178086ms elapsed_secs=0.307178086
2026-02-03T05:30:35.181321Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:30:59.700711Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:31:00.371686Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=307.416947ms elapsed_secs=0.307416947
2026-02-03T05:31:00.372207Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:31:00.372230Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:31:00.986182Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.975792ms elapsed_secs=0.307975792
2026-02-03T05:31:01.600395Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=306.850966ms elapsed_secs=0.306850966
2026-02-03T05:31:01.601079Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:31:01.601104Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:31:01.601196Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:31:01.601232Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:31:02.214585Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=306.871342ms elapsed_secs=0.306871342
2026-02-03T05:31:02.829944Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=307.90969ms elapsed_secs=0.30790969
2026-02-03T05:31:02.830175Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:31:02.830244Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:31:03.443643Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.19095ms elapsed_secs=0.30719095
2026-02-03T05:31:04.033585Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=283.006533ms elapsed_secs=0.283006533
2026-02-03T05:31:04.034233Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:31:04.034273Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:31:04.034399Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:31:04.034470Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:31:04.672172Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=306.935515ms elapsed_secs=0.306935515
2026-02-03T05:31:05.286638Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=307.018539ms elapsed_secs=0.307018539
2026-02-03T05:31:05.286927Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:31:29.700733Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:31:30.374818Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=306.659808ms elapsed_secs=0.306659808
2026-02-03T05:31:30.375724Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:31:30.375768Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:31:30.989048Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.163488ms elapsed_secs=0.307163488
2026-02-03T05:31:31.603603Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=307.533173ms elapsed_secs=0.307533173
2026-02-03T05:31:31.604405Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:31:31.604477Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:31:31.604693Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:31:31.604831Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:31:32.219677Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=308.996453ms elapsed_secs=0.308996453
2026-02-03T05:31:32.831917Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=307.138064ms elapsed_secs=0.307138064
2026-02-03T05:31:32.832127Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:31:32.832190Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:31:33.447795Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.125388ms elapsed_secs=0.307125388
2026-02-03T05:31:34.060995Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=307.118434ms elapsed_secs=0.307118434
2026-02-03T05:31:34.061579Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:31:34.061599Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:31:34.061664Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:31:34.061694Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:31:34.675274Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=306.143501ms elapsed_secs=0.306143501
2026-02-03T05:31:35.391757Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=409.338239ms elapsed_secs=0.409338239
2026-02-03T05:31:35.391877Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:31:59.700521Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:32:00.378982Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=308.81048ms elapsed_secs=0.30881048
2026-02-03T05:32:00.379863Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:32:00.379910Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:32:00.991462Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=306.648611ms elapsed_secs=0.306648611
2026-02-03T05:32:01.610261Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=310.757433ms elapsed_secs=0.310757433
2026-02-03T05:32:01.611050Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:32:01.611094Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:32:01.611246Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:32:01.611345Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:32:02.425511Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=409.532844ms elapsed_secs=0.409532844
2026-02-03T05:32:03.040841Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=307.985689ms elapsed_secs=0.307985689
2026-02-03T05:32:03.041163Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:32:03.041291Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:32:03.654455Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.201466ms elapsed_secs=0.307201466
2026-02-03T05:32:04.268365Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=306.393359ms elapsed_secs=0.306393359
2026-02-03T05:32:04.268964Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:32:04.269006Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:32:04.269091Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:32:04.269147Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:32:04.985760Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=410.184056ms elapsed_secs=0.410184056
2026-02-03T05:32:05.600032Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=307.139684ms elapsed_secs=0.307139684
2026-02-03T05:32:05.600358Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:32:29.699901Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:32:30.381310Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=307.83566ms elapsed_secs=0.30783566
2026-02-03T05:32:30.382137Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:32:30.382186Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:32:31.098837Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=410.578087ms elapsed_secs=0.410578087
2026-02-03T05:32:31.916959Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=406.498315ms elapsed_secs=0.406498315
2026-02-03T05:32:31.917694Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:32:31.917744Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:32:31.917889Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:32:31.917997Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:32:32.531143Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.476277ms elapsed_secs=0.307476277
2026-02-03T05:32:33.145143Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=306.97482ms elapsed_secs=0.30697482
2026-02-03T05:32:33.145406Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:32:33.145509Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:32:33.964729Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=409.658201ms elapsed_secs=0.409658201
2026-02-03T05:32:34.578976Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=307.239845ms elapsed_secs=0.307239845
2026-02-03T05:32:34.579569Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:32:34.579612Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:32:34.579726Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:32:34.579808Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:32:35.297651Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=411.694027ms elapsed_secs=0.411694027
2026-02-03T05:32:35.910128Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=307.059071ms elapsed_secs=0.307059071
2026-02-03T05:32:35.910421Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:32:59.700813Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:33:00.383962Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=307.689178ms elapsed_secs=0.307689178
2026-02-03T05:33:00.385144Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:33:00.385199Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:33:01.101134Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=410.014491ms elapsed_secs=0.410014491
2026-02-03T05:33:01.646363Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=271.366694ms elapsed_secs=0.271366694
2026-02-03T05:33:01.646922Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:33:01.646967Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:33:01.647081Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:33:01.647159Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:33:02.227476Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.664708ms elapsed_secs=0.307664708
2026-02-03T05:33:02.943753Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=409.390649ms elapsed_secs=0.409390649
2026-02-03T05:33:02.944092Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:33:02.944192Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:33:03.647049Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=293.543191ms elapsed_secs=0.293543191
2026-02-03T05:33:04.274779Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=345.164935ms elapsed_secs=0.345164935
2026-02-03T05:33:04.275385Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:33:04.275417Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:33:04.275516Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:33:04.275580Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:33:04.889513Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.556097ms elapsed_secs=0.307556097
2026-02-03T05:33:05.605701Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=408.674038ms elapsed_secs=0.408674038
2026-02-03T05:33:05.605979Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:33:29.700051Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:33:30.386795Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=307.32002ms elapsed_secs=0.30732002
2026-02-03T05:33:30.387334Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:33:30.387362Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:33:31.000871Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=306.931437ms elapsed_secs=0.306931437
2026-02-03T05:33:31.615232Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=306.951242ms elapsed_secs=0.306951242
2026-02-03T05:33:31.615956Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:33:31.616005Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:33:31.616131Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:33:31.616190Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:33:32.230265Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.09989ms elapsed_secs=0.30709989
2026-02-03T05:33:32.946435Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=409.142014ms elapsed_secs=0.409142014
2026-02-03T05:33:32.946768Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:33:32.946868Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:33:33.561032Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.467281ms elapsed_secs=0.307467281
2026-02-03T05:33:34.176517Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=308.165647ms elapsed_secs=0.308165647
2026-02-03T05:33:34.177137Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:33:34.177172Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:33:34.177266Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:33:34.177336Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:33:34.769346Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=286.580937ms elapsed_secs=0.286580937
2026-02-03T05:33:35.404202Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=309.527963ms elapsed_secs=0.309527963
2026-02-03T05:33:35.404429Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:33:59.700418Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:34:00.287762Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=307.764952ms elapsed_secs=0.307764952
2026-02-03T05:34:00.288370Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:34:00.288407Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:34:00.901608Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.073827ms elapsed_secs=0.307073827
2026-02-03T05:34:01.516182Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=307.090889ms elapsed_secs=0.307090889
2026-02-03T05:34:01.516661Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:34:01.516697Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:34:01.516815Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:34:01.516870Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:34:02.130778Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.489379ms elapsed_secs=0.307489379
2026-02-03T05:34:02.744446Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=306.891671ms elapsed_secs=0.306891671
2026-02-03T05:34:02.744694Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:34:02.744767Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:34:03.359179Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=306.844209ms elapsed_secs=0.306844209
2026-02-03T05:34:03.955215Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=288.515425ms elapsed_secs=0.288515425
2026-02-03T05:34:03.955985Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:34:03.956036Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:34:03.956165Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:34:03.956238Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:34:04.534688Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=288.308052ms elapsed_secs=0.288308052
2026-02-03T05:34:05.174819Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=279.858663ms elapsed_secs=0.279858663
2026-02-03T05:34:05.174991Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:34:29.700205Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:34:30.290519Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=307.499177ms elapsed_secs=0.307499177
2026-02-03T05:34:30.291443Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:34:30.291482Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:34:30.904870Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=306.857697ms elapsed_secs=0.306857697
2026-02-03T05:34:31.519194Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=307.171858ms elapsed_secs=0.307171858
2026-02-03T05:34:31.519939Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:34:31.519991Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:34:31.520151Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:34:31.520270Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:34:32.096294Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=269.995518ms elapsed_secs=0.269995518
2026-02-03T05:34:32.747405Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=306.463961ms elapsed_secs=0.306463961
2026-02-03T05:34:32.747656Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:34:32.747729Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:34:33.362417Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=316.21492ms elapsed_secs=0.31621492
2026-02-03T05:34:33.976838Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=307.164129ms elapsed_secs=0.307164129
2026-02-03T05:34:33.977579Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:34:33.977627Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:34:33.977789Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:34:33.977902Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:34:34.591406Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.385785ms elapsed_secs=0.307385785
2026-02-03T05:34:35.204874Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=306.50291ms elapsed_secs=0.30650291
2026-02-03T05:34:35.205175Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:34:59.699607Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:35:00.274041Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=286.537896ms elapsed_secs=0.286537896
2026-02-03T05:35:00.274812Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:35:00.274857Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:35:00.935929Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=335.395718ms elapsed_secs=0.335395718
2026-02-03T05:35:01.525314Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=310.195961ms elapsed_secs=0.310195961
2026-02-03T05:35:01.525826Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:35:01.525854Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:35:01.525956Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:35:01.526001Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:35:02.136328Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.410206ms elapsed_secs=0.307410206
2026-02-03T05:35:02.853306Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=408.902419ms elapsed_secs=0.408902419
2026-02-03T05:35:02.853644Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:35:02.853738Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:35:03.467815Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=306.048044ms elapsed_secs=0.306048044
2026-02-03T05:35:04.083462Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=308.502323ms elapsed_secs=0.308502323
2026-02-03T05:35:04.084123Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:35:04.084158Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:35:04.084233Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:35:04.084279Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:35:04.697684Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=308.30542ms elapsed_secs=0.30830542
2026-02-03T05:35:05.310860Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=322.605607ms elapsed_secs=0.322605607
2026-02-03T05:35:05.311124Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:35:29.699685Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:35:30.400614Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=309.484405ms elapsed_secs=0.309484405
2026-02-03T05:35:30.401520Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:35:30.401588Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:35:31.013202Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.710839ms elapsed_secs=0.307710839
2026-02-03T05:35:31.628420Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=308.509795ms elapsed_secs=0.308509795
2026-02-03T05:35:31.629260Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:35:31.629304Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:35:31.629436Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:35:31.629523Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:35:32.242817Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.574399ms elapsed_secs=0.307574399
2026-02-03T05:35:32.859258Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=310.324114ms elapsed_secs=0.310324114
2026-02-03T05:35:32.859492Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:35:32.859592Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:35:33.470637Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=305.90597ms elapsed_secs=0.30590597
2026-02-03T05:35:34.085205Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=307.250967ms elapsed_secs=0.307250967
2026-02-03T05:35:34.085875Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:35:34.085918Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:35:34.086043Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:35:34.086116Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:35:34.680423Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=287.541027ms elapsed_secs=0.287541027
2026-02-03T05:35:35.313871Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=341.395811ms elapsed_secs=0.341395811
2026-02-03T05:35:35.314174Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:35:59.699969Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:36:00.299443Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=308.064473ms elapsed_secs=0.308064473
2026-02-03T05:36:00.299897Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:36:00.299941Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:36:00.920619Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=314.500889ms elapsed_secs=0.314500889
2026-02-03T05:36:01.527741Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=307.254955ms elapsed_secs=0.307254955
2026-02-03T05:36:01.528454Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:36:01.528520Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:36:01.528701Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:36:01.528792Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:36:02.141942Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=322.683275ms elapsed_secs=0.322683275
2026-02-03T05:36:02.690937Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=279.915162ms elapsed_secs=0.279915162
2026-02-03T05:36:02.691224Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:36:02.691299Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:36:03.270283Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=311.17327ms elapsed_secs=0.31117327
2026-02-03T05:36:03.885031Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=308.969104ms elapsed_secs=0.308969104
2026-02-03T05:36:03.885729Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:36:03.885791Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:36:03.885920Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:36:03.885994Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:36:04.499372Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=308.741874ms elapsed_secs=0.308741874
2026-02-03T05:36:05.112282Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=341.328064ms elapsed_secs=0.341328064
2026-02-03T05:36:05.112605Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:36:29.699798Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:36:30.302500Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=307.534634ms elapsed_secs=0.307534634
2026-02-03T05:36:30.303478Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:36:30.303515Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:36:30.916823Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.334767ms elapsed_secs=0.307334767
2026-02-03T05:36:31.523799Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=300.495671ms elapsed_secs=0.300495671
2026-02-03T05:36:31.524459Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:36:31.524507Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:36:31.524666Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:36:31.524795Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:36:32.145328Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=346.073421ms elapsed_secs=0.346073421
2026-02-03T05:36:32.759459Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=305.583292ms elapsed_secs=0.305583292
2026-02-03T05:36:32.759709Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:36:32.759798Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:36:33.374095Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.279558ms elapsed_secs=0.307279558
2026-02-03T05:36:34.090880Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=409.565124ms elapsed_secs=0.409565124
2026-02-03T05:36:34.091452Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:36:34.091513Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:36:34.091660Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:36:34.091768Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:36:34.705292Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.096501ms elapsed_secs=0.307096501
2026-02-03T05:36:35.319823Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=306.615242ms elapsed_secs=0.306615242
2026-02-03T05:36:35.320040Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:36:59.700134Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:37:00.304899Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=306.955103ms elapsed_secs=0.306955103
2026-02-03T05:37:00.305679Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:37:00.305720Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:37:00.919947Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.279505ms elapsed_secs=0.307279505
2026-02-03T05:37:01.534379Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=307.496142ms elapsed_secs=0.307496142
2026-02-03T05:37:01.534948Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:37:01.534991Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:37:01.535089Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:37:01.535165Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:37:02.149807Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=308.73083ms elapsed_secs=0.30873083
2026-02-03T05:37:02.734158Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=299.981123ms elapsed_secs=0.299981123
2026-02-03T05:37:02.734381Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:37:02.734454Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:37:03.378154Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=356.278775ms elapsed_secs=0.356278775
2026-02-03T05:37:03.992174Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=307.684013ms elapsed_secs=0.307684013
2026-02-03T05:37:03.992957Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:37:03.993038Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:37:03.993179Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:37:03.993294Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:37:04.537753Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=271.602781ms elapsed_secs=0.271602781
2026-02-03T05:37:05.220292Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=398.239707ms elapsed_secs=0.398239707
2026-02-03T05:37:05.220588Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:37:29.700313Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:37:30.515054Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=411.925429ms elapsed_secs=0.411925429
2026-02-03T05:37:30.515764Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:37:30.515799Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:37:31.127524Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.257277ms elapsed_secs=0.307257277
2026-02-03T05:37:31.742049Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=306.566215ms elapsed_secs=0.306566215
2026-02-03T05:37:31.742671Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:37:31.742699Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:37:31.742800Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:37:31.742852Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:37:32.356178Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=325.946676ms elapsed_secs=0.325946676
2026-02-03T05:37:33.073666Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=410.010774ms elapsed_secs=0.410010774
2026-02-03T05:37:33.073890Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:37:33.073955Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:37:33.688347Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=308.484698ms elapsed_secs=0.308484698
2026-02-03T05:37:34.301900Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=306.655598ms elapsed_secs=0.306655598
2026-02-03T05:37:34.302640Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:37:34.302696Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:37:34.302845Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:37:34.302983Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:37:35.019753Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=410.60424ms elapsed_secs=0.41060424
2026-02-03T05:37:35.634500Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=308.687377ms elapsed_secs=0.308687377
2026-02-03T05:37:35.634630Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:37:59.700273Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:38:00.311451Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=307.71578ms elapsed_secs=0.30771578
2026-02-03T05:38:00.312305Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:38:00.312347Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:38:00.925971Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.765955ms elapsed_secs=0.307765955
2026-02-03T05:38:01.541755Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=308.781317ms elapsed_secs=0.308781317
2026-02-03T05:38:01.542596Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:38:01.542651Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:38:01.542827Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:38:01.542966Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:38:02.138648Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=291.369677ms elapsed_secs=0.291369677
2026-02-03T05:38:02.698409Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=292.013209ms elapsed_secs=0.292013209
2026-02-03T05:38:02.698623Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:38:02.698681Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:38:03.282113Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.020826ms elapsed_secs=0.307020826
2026-02-03T05:38:03.895402Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=307.132397ms elapsed_secs=0.307132397
2026-02-03T05:38:03.895973Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:38:03.896027Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:38:03.896152Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:38:03.896205Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:38:04.478449Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=288.344392ms elapsed_secs=0.288344392
2026-02-03T05:38:05.123941Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=337.761548ms elapsed_secs=0.337761548
2026-02-03T05:38:05.124232Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:38:29.700037Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:38:30.315444Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=307.311369ms elapsed_secs=0.307311369
2026-02-03T05:38:30.316403Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:38:30.316472Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:38:30.928701Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.196422ms elapsed_secs=0.307196422
2026-02-03T05:38:31.543089Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=307.207231ms elapsed_secs=0.307207231
2026-02-03T05:38:31.543816Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:38:31.543857Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:38:31.543981Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:38:31.544055Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:38:32.158169Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=306.903318ms elapsed_secs=0.306903318
2026-02-03T05:38:32.771322Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=306.008941ms elapsed_secs=0.306008941
2026-02-03T05:38:32.771443Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:38:32.771476Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:38:33.386269Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.321003ms elapsed_secs=0.307321003
2026-02-03T05:38:34.001795Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=308.50749ms elapsed_secs=0.30850749
2026-02-03T05:38:34.002498Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:38:34.002554Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:38:34.002680Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:38:34.002747Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:38:34.615114Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.278251ms elapsed_secs=0.307278251
2026-02-03T05:38:35.229166Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=306.923641ms elapsed_secs=0.306923641
2026-02-03T05:38:35.229463Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:38:59.700959Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:39:00.318455Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=307.869272ms elapsed_secs=0.307869272
2026-02-03T05:39:00.319074Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:39:00.319094Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:39:00.931059Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=306.494251ms elapsed_secs=0.306494251
2026-02-03T05:39:01.546256Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=304.420002ms elapsed_secs=0.304420002
2026-02-03T05:39:01.546789Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:39:01.546825Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:39:01.546921Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:39:01.546985Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:39:02.142345Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=288.143615ms elapsed_secs=0.288143615
2026-02-03T05:39:02.775014Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=332.625758ms elapsed_secs=0.332625758
2026-02-03T05:39:02.775295Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:39:02.775389Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:39:03.366081Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=299.860906ms elapsed_secs=0.299860906
2026-02-03T05:39:04.003673Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=360.6687ms elapsed_secs=0.3606687
2026-02-03T05:39:04.004211Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:39:04.004242Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:39:04.004338Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:39:04.004372Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:39:04.618253Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.752167ms elapsed_secs=0.307752167
2026-02-03T05:39:05.334717Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=409.597333ms elapsed_secs=0.409597333
2026-02-03T05:39:05.334948Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:39:29.700304Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:39:30.740812Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=532.348557ms elapsed_secs=0.532348557
2026-02-03T05:39:30.741769Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:39:30.741808Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:39:31.592772Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=556.001603ms elapsed_secs=0.556001603
2026-02-03T05:39:32.368092Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=317.290982ms elapsed_secs=0.317290982
2026-02-03T05:39:32.368851Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:39:32.368898Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:39:32.369025Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:39:32.369114Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:39:32.985443Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=310.034194ms elapsed_secs=0.310034194
2026-02-03T05:39:33.699196Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=409.101704ms elapsed_secs=0.409101704
2026-02-03T05:39:33.699445Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:39:33.699517Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:39:34.313307Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=305.75063ms elapsed_secs=0.30575063
2026-02-03T05:39:34.928066Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=306.13758ms elapsed_secs=0.30613758
2026-02-03T05:39:34.928718Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:39:34.928769Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:39:34.928881Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:39:34.928959Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:39:35.543679Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=308.672564ms elapsed_secs=0.308672564
2026-02-03T05:39:36.260467Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=410.811392ms elapsed_secs=0.410811392
2026-02-03T05:39:36.260710Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:39:59.700519Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:40:00.322830Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=307.262309ms elapsed_secs=0.307262309
2026-02-03T05:40:00.323607Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:40:00.323646Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:40:00.939050Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=308.66856ms elapsed_secs=0.30866856
2026-02-03T05:40:01.551887Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=306.785982ms elapsed_secs=0.306785982
2026-02-03T05:40:01.552402Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:40:01.552441Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:40:01.552558Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:40:01.552624Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:40:02.167675Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=308.477998ms elapsed_secs=0.308477998
2026-02-03T05:40:02.780321Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=337.151242ms elapsed_secs=0.337151242
2026-02-03T05:40:02.780632Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:40:02.780709Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:40:03.395329Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.741159ms elapsed_secs=0.307741159
2026-02-03T05:40:03.980404Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=288.185588ms elapsed_secs=0.288185588
2026-02-03T05:40:03.981165Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:40:03.981207Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:40:03.981331Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:40:03.981377Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:40:04.626452Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=309.983853ms elapsed_secs=0.309983853
2026-02-03T05:40:05.237985Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=306.604635ms elapsed_secs=0.306604635
2026-02-03T05:40:05.238157Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:40:29.700287Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:40:30.325908Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=306.925804ms elapsed_secs=0.306925804
2026-02-03T05:40:30.326755Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:40:30.326798Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:40:30.941644Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=331.643852ms elapsed_secs=0.331643852
2026-02-03T05:40:31.554643Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=306.818332ms elapsed_secs=0.306818332
2026-02-03T05:40:31.555161Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:40:31.555201Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:40:31.555297Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:40:31.555377Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:40:32.135530Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=273.474348ms elapsed_secs=0.273474348
2026-02-03T05:40:32.783793Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=307.499443ms elapsed_secs=0.307499443
2026-02-03T05:40:32.784120Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:40:32.784209Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:40:33.398440Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=306.162884ms elapsed_secs=0.306162884
2026-02-03T05:40:33.998180Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=292.882279ms elapsed_secs=0.292882279
2026-02-03T05:40:33.998858Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:40:33.998905Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:40:33.999027Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:40:33.999116Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:40:34.627030Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=306.576863ms elapsed_secs=0.306576863
2026-02-03T05:40:35.241910Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=307.792683ms elapsed_secs=0.307792683
2026-02-03T05:40:35.242203Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:40:59.700453Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:41:00.330508Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=308.905976ms elapsed_secs=0.308905976
2026-02-03T05:41:00.331394Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:41:00.331429Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:41:00.946818Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=310.519905ms elapsed_secs=0.310519905
2026-02-03T05:41:01.533371Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=283.193797ms elapsed_secs=0.283193797
2026-02-03T05:41:01.534050Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:41:01.534093Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:41:01.534217Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:41:01.534292Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:41:02.171835Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=306.584501ms elapsed_secs=0.306584501
2026-02-03T05:41:02.888985Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=407.91837ms elapsed_secs=0.40791837
2026-02-03T05:41:02.889274Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:41:02.889352Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:41:03.617104Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=318.974005ms elapsed_secs=0.318974005
2026-02-03T05:41:04.219931Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=307.958216ms elapsed_secs=0.307958216
2026-02-03T05:41:04.220264Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:41:04.220286Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:41:04.220374Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:41:04.220425Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:41:04.835614Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.014508ms elapsed_secs=0.307014508
2026-02-03T05:41:05.552309Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=410.39331ms elapsed_secs=0.41039331
2026-02-03T05:41:05.552530Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:41:29.700698Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:41:30.333094Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=308.145455ms elapsed_secs=0.308145455
2026-02-03T05:41:30.333991Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:41:30.334034Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:41:30.947748Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.56963ms elapsed_secs=0.30756963
2026-02-03T05:41:31.562225Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=309.064104ms elapsed_secs=0.309064104
2026-02-03T05:41:31.563033Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:41:31.563074Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:41:31.563192Z  INFO ThreadId(10) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:41:31.563263Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:41:32.279885Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=408.483548ms elapsed_secs=0.408483548
2026-02-03T05:41:33.098224Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=409.735207ms elapsed_secs=0.409735207
2026-02-03T05:41:33.098520Z ERROR ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:41:33.098640Z  INFO ThreadId(10) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:41:33.915905Z  INFO ThreadId(10) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=408.870115ms elapsed_secs=0.408870115
2026-02-03T05:41:34.531878Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=307.678171ms elapsed_secs=0.307678171
2026-02-03T05:41:34.532741Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:41:34.532769Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:41:34.532859Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:41:34.532896Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:41:35.148158Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=310.005435ms elapsed_secs=0.310005435
2026-02-03T05:41:35.861237Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=408.289159ms elapsed_secs=0.408289159
2026-02-03T05:41:35.861458Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:41:59.700725Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T05:42:00.334943Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=307.367693ms elapsed_secs=0.307367693
2026-02-03T05:42:00.335510Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T05:42:00.335529Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T05:42:01.051955Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=409.709445ms elapsed_secs=0.409709445
2026-02-03T05:42:01.667059Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=308.043956ms elapsed_secs=0.308043956
2026-02-03T05:42:01.667748Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T05:42:01.667805Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:42:01.667963Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:42:01.668109Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:42:02.280068Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=315.921969ms elapsed_secs=0.315921969
2026-02-03T05:42:02.894448Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=305.86489ms elapsed_secs=0.30586489
2026-02-03T05:42:02.894772Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T05:42:02.894856Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T05:42:03.490467Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=287.849716ms elapsed_secs=0.287849716
2026-02-03T05:42:04.123720Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=307.481064ms elapsed_secs=0.307481064
2026-02-03T05:42:04.124258Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T05:42:04.124298Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:42:04.124395Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T05:42:04.124466Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T05:42:04.738155Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.30984ms elapsed_secs=0.30730984
2026-02-03T05:42:05.352373Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=307.241902ms elapsed_secs=0.307241902
2026-02-03T05:42:05.352649Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T06:09:20.298975Z  INFO ThreadId(01) vscu: src/main.rs:30: Starting VSCU middleware service
2026-02-03T06:09:20.299476Z  WARN ThreadId(01) sqlx_postgres::options::parse: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-postgres-0.8.6/src/options/parse.rs:107: ignoring unrecognized connect parameter key=channel_binding value=require
2026-02-03T06:09:22.868404Z  WARN ThreadId(01) sqlx::pool::acquire: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/pool/inner.rs:302: acquired connection, but time to acquire exceeded slow threshold aquired_after_secs=2.568775456 slow_acquire_threshold_secs=2.0
2026-02-03T06:09:22.869440Z  INFO ThreadId(01) vscu: src/main.rs:64: Server listening on 0.0.0.0:8000
2026-02-03T06:09:22.869982Z  INFO ThreadId(03) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T06:09:23.892888Z  INFO ThreadId(03) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=716.086421ms elapsed_secs=0.716086421
2026-02-03T06:09:23.893707Z  INFO ThreadId(03) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T06:09:23.893744Z  INFO ThreadId(03) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T06:09:26.452623Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=612.483119ms elapsed_secs=0.612483119
2026-02-03T06:09:27.481391Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=720.424194ms elapsed_secs=0.720424194
2026-02-03T06:09:27.482067Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T06:09:27.482110Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:09:27.482263Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:09:27.482346Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T06:09:28.093315Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=309.130096ms elapsed_secs=0.309130096
2026-02-03T06:09:28.706752Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=308.206986ms elapsed_secs=0.308206986
2026-02-03T06:09:28.706925Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T06:09:28.706980Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T06:09:29.320052Z  INFO ThreadId(03) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=305.627148ms elapsed_secs=0.305627148
2026-02-03T06:09:29.934864Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=307.373212ms elapsed_secs=0.307373212
2026-02-03T06:09:29.935384Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T06:09:29.935425Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:09:29.935522Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:09:29.935639Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T06:09:30.549583Z  INFO ThreadId(03) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.59962ms elapsed_secs=0.30759962
2026-02-03T06:09:31.163151Z  INFO ThreadId(03) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=306.128387ms elapsed_secs=0.306128387
2026-02-03T06:09:31.163363Z ERROR ThreadId(03) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T06:09:52.871809Z  INFO ThreadId(03) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T06:09:53.795225Z  INFO ThreadId(03) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=615.149887ms elapsed_secs=0.615149887
2026-02-03T06:09:53.796172Z  INFO ThreadId(03) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T06:09:53.796212Z  INFO ThreadId(03) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T06:09:54.716900Z  INFO ThreadId(03) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=614.765875ms elapsed_secs=0.614765875
2026-02-03T06:09:55.637717Z  INFO ThreadId(03) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=613.485416ms elapsed_secs=0.613485416
2026-02-03T06:09:55.638381Z  INFO ThreadId(03) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T06:09:55.638442Z  INFO ThreadId(03) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:09:55.638612Z  INFO ThreadId(03) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:09:55.638711Z ERROR ThreadId(03) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T06:09:56.253487Z  INFO ThreadId(03) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.940951ms elapsed_secs=0.307940951
2026-02-03T06:09:56.808220Z  INFO ThreadId(03) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=284.831235ms elapsed_secs=0.284831235
2026-02-03T06:09:56.808435Z ERROR ThreadId(03) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T06:09:56.808504Z  INFO ThreadId(03) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T06:09:58.812101Z  WARN ThreadId(13) sqlx::pool::acquire: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/pool/inner.rs:302: acquired connection, but time to acquire exceeded slow threshold aquired_after_secs=2.003086153 slow_acquire_threshold_secs=2.0
2026-02-03T06:09:59.427002Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=614.675393ms elapsed_secs=0.614675393
2026-02-03T06:10:00.041945Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=308.163853ms elapsed_secs=0.308163853
2026-02-03T06:10:00.042517Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T06:10:00.042578Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:10:00.042675Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:10:00.042746Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T06:10:00.655435Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=306.96909ms elapsed_secs=0.30696909
2026-02-03T06:10:01.271024Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=308.440618ms elapsed_secs=0.308440618
2026-02-03T06:10:01.271341Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T06:10:22.869909Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T06:10:23.492225Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=308.002432ms elapsed_secs=0.308002432
2026-02-03T06:10:23.493130Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T06:10:23.493174Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T06:10:24.106712Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=303.654425ms elapsed_secs=0.303654425
2026-02-03T06:10:25.027883Z  INFO ThreadId(03) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=614.325872ms elapsed_secs=0.614325872
2026-02-03T06:10:25.028659Z  INFO ThreadId(03) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T06:10:25.028706Z  INFO ThreadId(03) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:10:25.028831Z  INFO ThreadId(03) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:10:25.028921Z ERROR ThreadId(03) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T06:10:25.644631Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=309.978881ms elapsed_secs=0.309978881
2026-02-03T06:10:26.207962Z  INFO ThreadId(03) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=278.763715ms elapsed_secs=0.278763715
2026-02-03T06:10:26.208258Z ERROR ThreadId(03) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T06:10:26.208342Z  INFO ThreadId(03) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T06:10:26.769783Z  INFO ThreadId(03) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=281.78366ms elapsed_secs=0.28178366
2026-02-03T06:10:27.383299Z  INFO ThreadId(03) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=306.294734ms elapsed_secs=0.306294734
2026-02-03T06:10:27.383930Z  INFO ThreadId(03) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T06:10:27.383968Z  INFO ThreadId(03) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:10:27.384064Z  INFO ThreadId(03) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:10:27.384129Z ERROR ThreadId(03) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T06:10:27.997180Z  INFO ThreadId(03) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=306.329181ms elapsed_secs=0.306329181
2026-02-03T06:10:28.613299Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=308.308171ms elapsed_secs=0.308308171
2026-02-03T06:10:28.613584Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T06:10:52.870385Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T06:10:53.495290Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=306.055274ms elapsed_secs=0.306055274
2026-02-03T06:10:53.496059Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T06:10:53.496117Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T06:10:54.110178Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=344.628783ms elapsed_secs=0.344628783
2026-02-03T06:10:54.727892Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=310.837079ms elapsed_secs=0.310837079
2026-02-03T06:10:54.728298Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T06:10:54.728333Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:10:54.728420Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:10:54.728472Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T06:10:55.339466Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=306.119328ms elapsed_secs=0.306119328
2026-02-03T06:10:55.913411Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=266.764255ms elapsed_secs=0.266764255
2026-02-03T06:10:55.913647Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T06:10:55.913719Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T06:10:56.569136Z  INFO ThreadId(03) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=383.965653ms elapsed_secs=0.383965653
2026-02-03T06:10:57.129618Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=286.434206ms elapsed_secs=0.286434206
2026-02-03T06:10:57.130262Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T06:10:57.130305Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:10:57.130409Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:10:57.130501Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T06:10:57.695596Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=290.694034ms elapsed_secs=0.290694034
2026-02-03T06:10:58.284268Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=282.338194ms elapsed_secs=0.282338194
2026-02-03T06:10:58.284485Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T06:11:22.870115Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T06:11:23.499537Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=306.999982ms elapsed_secs=0.306999982
2026-02-03T06:11:23.500338Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T06:11:23.500372Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T06:11:24.118256Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=309.59971ms elapsed_secs=0.30959971
2026-02-03T06:11:24.729533Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=308.154796ms elapsed_secs=0.308154796
2026-02-03T06:11:24.730063Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T06:11:24.730100Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:11:24.730221Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:11:24.730319Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T06:11:25.343450Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.915461ms elapsed_secs=0.307915461
2026-02-03T06:11:25.959077Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=308.918788ms elapsed_secs=0.308918788
2026-02-03T06:11:25.959292Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T06:11:25.959370Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T06:11:26.503399Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=276.549444ms elapsed_secs=0.276549444
2026-02-03T06:11:27.050887Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=276.761059ms elapsed_secs=0.276761059
2026-02-03T06:11:27.051368Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T06:11:27.051430Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:11:27.051567Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:11:27.051624Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T06:11:27.662978Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=270.314709ms elapsed_secs=0.270314709
2026-02-03T06:11:28.218522Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=281.261911ms elapsed_secs=0.281261911
2026-02-03T06:11:28.218801Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T06:11:52.869841Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T06:11:53.504740Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=308.516869ms elapsed_secs=0.308516869
2026-02-03T06:11:53.505517Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T06:11:53.505592Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T06:11:54.119301Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=308.284488ms elapsed_secs=0.308284488
2026-02-03T06:11:54.732081Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=338.23168ms elapsed_secs=0.33823168
2026-02-03T06:11:54.732655Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T06:11:54.732708Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:11:54.732831Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:11:54.732926Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T06:11:55.346876Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=306.13964ms elapsed_secs=0.30613964
2026-02-03T06:11:55.961118Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=306.454434ms elapsed_secs=0.306454434
2026-02-03T06:11:55.961334Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T06:11:55.961399Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T06:11:56.506701Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=272.729654ms elapsed_secs=0.272729654
2026-02-03T06:11:57.087626Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=303.330183ms elapsed_secs=0.303330183
2026-02-03T06:11:57.088093Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T06:11:57.088126Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:11:57.088226Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:11:57.088273Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T06:11:57.703134Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=348.50483ms elapsed_secs=0.34850483
2026-02-03T06:11:58.294329Z  INFO ThreadId(03) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=284.776066ms elapsed_secs=0.284776066
2026-02-03T06:11:58.294463Z ERROR ThreadId(03) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T06:12:22.870238Z  INFO ThreadId(03) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T06:12:23.428442Z  INFO ThreadId(03) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=280.148481ms elapsed_secs=0.280148481
2026-02-03T06:12:23.429179Z  INFO ThreadId(03) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T06:12:23.429241Z  INFO ThreadId(03) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T06:12:23.968081Z  INFO ThreadId(03) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=267.55013ms elapsed_secs=0.26755013
2026-02-03T06:12:24.527563Z  INFO ThreadId(03) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=280.21592ms elapsed_secs=0.28021592
2026-02-03T06:12:24.528290Z  INFO ThreadId(03) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T06:12:24.528353Z  INFO ThreadId(03) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:12:24.528466Z  INFO ThreadId(03) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:12:24.528517Z ERROR ThreadId(03) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T06:12:29.960361Z  WARN ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:125: slow statement: execution time exceeded alert threshold summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=5.12176186s elapsed_secs=5.12176186 slow_threshold=1s
2026-02-03T06:12:30.474869Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=259.621801ms elapsed_secs=0.259621801
2026-02-03T06:12:30.474997Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T06:12:30.475030Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T06:12:31.011704Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=233.775838ms elapsed_secs=0.233775838
2026-02-03T06:12:31.905339Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=626.208526ms elapsed_secs=0.626208526
2026-02-03T06:12:31.906008Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T06:12:31.906059Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:12:31.906164Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:12:31.906236Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T06:12:32.416756Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=264.91559ms elapsed_secs=0.26491559
2026-02-03T06:12:33.030438Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=306.7471ms elapsed_secs=0.3067471
2026-02-03T06:12:33.030686Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T06:12:52.869807Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T06:12:53.464245Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=296.375528ms elapsed_secs=0.296375528
2026-02-03T06:12:53.465407Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T06:12:53.465468Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T06:12:54.125837Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=306.91834ms elapsed_secs=0.30691834
2026-02-03T06:12:54.740593Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=307.274465ms elapsed_secs=0.307274465
2026-02-03T06:12:54.741419Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T06:12:54.741482Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:12:54.741677Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:12:54.741760Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T06:12:55.344885Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=295.414943ms elapsed_secs=0.295414943
2026-02-03T06:12:55.969124Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=306.104701ms elapsed_secs=0.306104701
2026-02-03T06:12:55.969308Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T06:12:55.969365Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T06:12:56.583885Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=339.958241ms elapsed_secs=0.339958241
2026-02-03T06:12:57.189346Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=298.641058ms elapsed_secs=0.298641058
2026-02-03T06:12:57.190009Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T06:12:57.190060Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:12:57.190183Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:12:57.190265Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T06:12:57.813950Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=352.675951ms elapsed_secs=0.352675951
2026-02-03T06:12:58.427569Z  INFO ThreadId(03) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=303.575148ms elapsed_secs=0.303575148
2026-02-03T06:12:58.427789Z ERROR ThreadId(03) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T06:13:22.870249Z  INFO ThreadId(03) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T06:13:23.926828Z  INFO ThreadId(03) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=718.671368ms elapsed_secs=0.718671368
2026-02-03T06:13:23.928010Z  INFO ThreadId(03) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T06:13:23.928058Z  INFO ThreadId(03) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T06:13:24.540620Z  INFO ThreadId(03) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.299507ms elapsed_secs=0.307299507
2026-02-03T06:13:25.154276Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=339.721715ms elapsed_secs=0.339721715
2026-02-03T06:13:25.154757Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T06:13:25.154827Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:13:25.154919Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:13:25.154953Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T06:13:25.768456Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.397954ms elapsed_secs=0.307397954
2026-02-03T06:13:26.341357Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=291.679195ms elapsed_secs=0.291679195
2026-02-03T06:13:26.341682Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T06:13:26.341759Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T06:13:27.099909Z  INFO ThreadId(03) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=409.660133ms elapsed_secs=0.409660133
2026-02-03T06:13:27.696749Z  INFO ThreadId(03) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=296.164816ms elapsed_secs=0.296164816
2026-02-03T06:13:27.697561Z  INFO ThreadId(03) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T06:13:27.697608Z  INFO ThreadId(03) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:13:27.697757Z  INFO ThreadId(03) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:13:27.697870Z ERROR ThreadId(03) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T06:13:28.329711Z  INFO ThreadId(03) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=306.764297ms elapsed_secs=0.306764297
2026-02-03T06:13:28.942886Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=306.236506ms elapsed_secs=0.306236506
2026-02-03T06:13:28.943103Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T06:13:52.870849Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T06:13:53.623218Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=409.872733ms elapsed_secs=0.409872733
2026-02-03T06:13:53.624118Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T06:13:53.624159Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T06:13:54.237842Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=308.502476ms elapsed_secs=0.308502476
2026-02-03T06:13:54.823253Z  INFO ThreadId(03) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=279.531822ms elapsed_secs=0.279531822
2026-02-03T06:13:54.823941Z  INFO ThreadId(03) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T06:13:54.823990Z  INFO ThreadId(03) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:13:54.824112Z  INFO ThreadId(03) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:13:54.824202Z ERROR ThreadId(03) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T06:13:55.571843Z  INFO ThreadId(03) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=412.786141ms elapsed_secs=0.412786141
2026-02-03T06:13:56.181068Z  INFO ThreadId(03) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=306.104556ms elapsed_secs=0.306104556
2026-02-03T06:13:56.181220Z ERROR ThreadId(03) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T06:13:56.181253Z  INFO ThreadId(03) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T06:13:56.797649Z  INFO ThreadId(03) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=303.692153ms elapsed_secs=0.303692153
2026-02-03T06:13:57.414061Z  INFO ThreadId(03) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=317.886365ms elapsed_secs=0.317886365
2026-02-03T06:13:57.414587Z  INFO ThreadId(03) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T06:13:57.414628Z  INFO ThreadId(03) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:13:57.414724Z  INFO ThreadId(03) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:13:57.414801Z ERROR ThreadId(03) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T06:13:58.025896Z  INFO ThreadId(03) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.310539ms elapsed_secs=0.307310539
2026-02-03T06:13:58.639534Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=307.140625ms elapsed_secs=0.307140625
2026-02-03T06:13:58.639779Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T06:14:04.100260Z  INFO ThreadId(01) vscu: src/main.rs:30: Starting VSCU middleware service
2026-02-03T06:14:04.100795Z  WARN ThreadId(01) sqlx_postgres::options::parse: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-postgres-0.8.6/src/options/parse.rs:107: ignoring unrecognized connect parameter key=channel_binding value=require
2026-02-03T06:14:06.524947Z  WARN ThreadId(01) sqlx::pool::acquire: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/pool/inner.rs:302: acquired connection, but time to acquire exceeded slow threshold aquired_after_secs=2.4239865529999998 slow_acquire_threshold_secs=2.0
2026-02-03T06:14:06.526317Z  INFO ThreadId(01) vscu: src/main.rs:64: Server listening on 0.0.0.0:8000
2026-02-03T06:14:06.526512Z  INFO ThreadId(04) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T06:14:07.429096Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=628.38365ms elapsed_secs=0.62838365
2026-02-03T06:14:07.429849Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T06:14:07.429886Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T06:14:09.792709Z  INFO ThreadId(04) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=560.535194ms elapsed_secs=0.560535194
2026-02-03T06:14:10.726453Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=658.344762ms elapsed_secs=0.658344762
2026-02-03T06:14:10.726945Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T06:14:10.726978Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:14:10.727120Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:14:10.727183Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T06:14:11.292475Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=276.288784ms elapsed_secs=0.276288784
2026-02-03T06:14:11.951631Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=306.481519ms elapsed_secs=0.306481519
2026-02-03T06:14:11.951806Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T06:14:11.951861Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T06:14:12.567195Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=281.528162ms elapsed_secs=0.281528162
2026-02-03T06:14:13.182296Z  INFO ThreadId(04) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=308.865475ms elapsed_secs=0.308865475
2026-02-03T06:14:13.183055Z  INFO ThreadId(04) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T06:14:13.183140Z  INFO ThreadId(04) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:14:13.183297Z  INFO ThreadId(04) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:14:13.183415Z ERROR ThreadId(04) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T06:14:13.795331Z  INFO ThreadId(04) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=304.133774ms elapsed_secs=0.304133774
2026-02-03T06:14:14.353965Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=284.240805ms elapsed_secs=0.284240805
2026-02-03T06:14:14.354237Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T06:14:36.526596Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T06:14:37.451472Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=615.184424ms elapsed_secs=0.615184424
2026-02-03T06:14:37.452309Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T06:14:37.452345Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T06:14:38.372388Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=614.90472ms elapsed_secs=0.61490472
2026-02-03T06:14:39.293530Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=614.509508ms elapsed_secs=0.614509508
2026-02-03T06:14:39.294286Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T06:14:39.294334Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:14:39.294460Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:14:39.294532Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T06:14:39.908279Z  INFO ThreadId(04) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.732844ms elapsed_secs=0.307732844
2026-02-03T06:14:40.522279Z  INFO ThreadId(04) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=307.054878ms elapsed_secs=0.307054878
2026-02-03T06:14:40.522572Z ERROR ThreadId(04) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T06:14:40.522635Z  INFO ThreadId(04) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T06:14:41.136765Z  INFO ThreadId(04) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=336.827315ms elapsed_secs=0.336827315
2026-02-03T06:14:41.737271Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=293.336506ms elapsed_secs=0.293336506
2026-02-03T06:14:41.737821Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T06:14:41.737842Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:14:41.737903Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:14:41.737936Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T06:14:42.365498Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.384499ms elapsed_secs=0.307384499
2026-02-03T06:14:43.491362Z  INFO ThreadId(04) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=819.610402ms elapsed_secs=0.819610402
2026-02-03T06:14:43.491570Z ERROR ThreadId(04) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T06:15:06.525789Z  INFO ThreadId(04) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T06:15:07.128068Z  INFO ThreadId(04) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=288.821143ms elapsed_secs=0.288821143
2026-02-03T06:15:07.128971Z  INFO ThreadId(04) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T06:15:07.129013Z  INFO ThreadId(04) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T06:15:07.760372Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=345.248693ms elapsed_secs=0.345248693
2026-02-03T06:15:08.366771Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=298.48086ms elapsed_secs=0.29848086
2026-02-03T06:15:08.367153Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T06:15:08.367191Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:15:08.367270Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:15:08.367307Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T06:15:08.990679Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=306.275504ms elapsed_secs=0.306275504
2026-02-03T06:15:09.707862Z  INFO ThreadId(04) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=387.525066ms elapsed_secs=0.387525066
2026-02-03T06:15:09.708150Z ERROR ThreadId(04) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T06:15:09.708286Z  INFO ThreadId(04) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T06:15:10.295068Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=281.746036ms elapsed_secs=0.281746036
2026-02-03T06:15:10.844144Z  INFO ThreadId(04) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=276.708655ms elapsed_secs=0.276708655
2026-02-03T06:15:10.844806Z  INFO ThreadId(04) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T06:15:10.844846Z  INFO ThreadId(04) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:15:10.844967Z  INFO ThreadId(04) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:15:10.845077Z ERROR ThreadId(04) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T06:15:11.448405Z  INFO ThreadId(04) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=322.884572ms elapsed_secs=0.322884572
2026-02-03T06:15:12.027334Z  INFO ThreadId(04) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=297.773331ms elapsed_secs=0.297773331
2026-02-03T06:15:12.027612Z ERROR ThreadId(04) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T06:15:36.526469Z  INFO ThreadId(04) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T06:15:37.150287Z  INFO ThreadId(04) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=307.056875ms elapsed_secs=0.307056875
2026-02-03T06:15:37.151397Z  INFO ThreadId(04) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T06:15:37.151454Z  INFO ThreadId(04) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T06:15:37.770142Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=312.740393ms elapsed_secs=0.312740393
2026-02-03T06:15:38.380461Z  INFO ThreadId(04) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=308.022036ms elapsed_secs=0.308022036
2026-02-03T06:15:38.381208Z  INFO ThreadId(04) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T06:15:38.381258Z  INFO ThreadId(04) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:15:38.381441Z  INFO ThreadId(04) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:15:38.381595Z ERROR ThreadId(04) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T06:15:38.993893Z  INFO ThreadId(04) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=329.009248ms elapsed_secs=0.329009248
2026-02-03T06:15:39.608067Z  INFO ThreadId(04) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=324.956462ms elapsed_secs=0.324956462
2026-02-03T06:15:39.608313Z ERROR ThreadId(04) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T06:15:39.608455Z  INFO ThreadId(04) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T06:15:40.222933Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=305.784726ms elapsed_secs=0.305784726
2026-02-03T06:15:40.837084Z  INFO ThreadId(04) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=307.654597ms elapsed_secs=0.307654597
2026-02-03T06:15:40.837657Z  INFO ThreadId(04) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T06:15:40.837700Z  INFO ThreadId(04) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:15:40.837799Z  INFO ThreadId(04) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:15:40.837869Z ERROR ThreadId(04) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T06:15:41.452863Z  INFO ThreadId(04) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=309.005881ms elapsed_secs=0.309005881
2026-02-03T06:15:42.065406Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=307.011137ms elapsed_secs=0.307011137
2026-02-03T06:15:42.065657Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T06:16:06.528778Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T06:16:07.113749Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=312.971815ms elapsed_secs=0.312971815
2026-02-03T06:16:07.114160Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T06:16:07.114182Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T06:16:07.666671Z  INFO ThreadId(04) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=281.60738ms elapsed_secs=0.28160738
2026-02-03T06:16:08.275053Z  INFO ThreadId(04) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=301.940637ms elapsed_secs=0.301940637
2026-02-03T06:16:08.275568Z  INFO ThreadId(04) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T06:16:08.275626Z  INFO ThreadId(04) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:16:08.275754Z  INFO ThreadId(04) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:16:08.275846Z ERROR ThreadId(04) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T06:16:08.896234Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=308.189945ms elapsed_secs=0.308189945
2026-02-03T06:16:09.509531Z  INFO ThreadId(04) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=306.64734ms elapsed_secs=0.30664734
2026-02-03T06:16:09.509862Z ERROR ThreadId(04) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T06:16:09.509947Z  INFO ThreadId(04) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T06:16:10.125581Z  INFO ThreadId(04) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=340.472965ms elapsed_secs=0.340472965
2026-02-03T06:16:10.738417Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=305.534837ms elapsed_secs=0.305534837
2026-02-03T06:16:10.738971Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T06:16:10.739012Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:16:10.739136Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:16:10.739257Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T06:16:11.318888Z  INFO ThreadId(04) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=273.039583ms elapsed_secs=0.273039583
2026-02-03T06:16:11.967054Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=306.872313ms elapsed_secs=0.306872313
2026-02-03T06:16:11.967300Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T06:16:36.526271Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T06:16:37.157895Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=347.772978ms elapsed_secs=0.347772978
2026-02-03T06:16:37.158663Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T06:16:37.158701Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T06:16:37.772952Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=308.284917ms elapsed_secs=0.308284917
2026-02-03T06:16:38.388263Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=308.969266ms elapsed_secs=0.308969266
2026-02-03T06:16:38.388829Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T06:16:38.388876Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:16:38.389008Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:16:38.389140Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T06:16:39.001991Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=308.255323ms elapsed_secs=0.308255323
2026-02-03T06:16:39.719475Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=411.34944ms elapsed_secs=0.41134944
2026-02-03T06:16:39.719807Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T06:16:39.719893Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T06:16:40.332934Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=323.390569ms elapsed_secs=0.323390569
2026-02-03T06:16:40.946925Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=339.862803ms elapsed_secs=0.339862803
2026-02-03T06:16:40.947458Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T06:16:40.947478Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:16:40.947537Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:16:40.947584Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T06:16:41.664171Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=410.388184ms elapsed_secs=0.410388184
2026-02-03T06:16:42.381240Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=410.705491ms elapsed_secs=0.410705491
2026-02-03T06:16:42.381512Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T06:17:06.526631Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T06:17:07.100016Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=295.429758ms elapsed_secs=0.295429758
2026-02-03T06:17:07.100823Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T06:17:07.100867Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T06:17:07.748179Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=279.50239ms elapsed_secs=0.27950239
2026-02-03T06:17:08.304051Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=275.868346ms elapsed_secs=0.275868346
2026-02-03T06:17:08.304595Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T06:17:08.304638Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:17:08.304758Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:17:08.304863Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T06:17:08.902331Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=305.78374ms elapsed_secs=0.30578374
2026-02-03T06:17:09.517872Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=341.667139ms elapsed_secs=0.341667139
2026-02-03T06:17:09.518112Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T06:17:09.518207Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T06:17:10.134495Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=342.068452ms elapsed_secs=0.342068452
2026-02-03T06:17:10.746125Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=306.461459ms elapsed_secs=0.306461459
2026-02-03T06:17:10.746607Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T06:17:10.746649Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:17:10.746754Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:17:10.746824Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T06:17:11.330248Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=277.512034ms elapsed_secs=0.277512034
2026-02-03T06:17:12.076667Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=409.325067ms elapsed_secs=0.409325067
2026-02-03T06:17:12.076932Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T06:17:36.526658Z  INFO ThreadId(04) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T06:17:37.166056Z  INFO ThreadId(04) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=308.125169ms elapsed_secs=0.308125169
2026-02-03T06:17:37.166782Z  INFO ThreadId(04) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T06:17:37.166819Z  INFO ThreadId(04) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T06:17:37.752443Z  INFO ThreadId(04) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=280.0703ms elapsed_secs=0.2800703
2026-02-03T06:17:38.394886Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=307.103779ms elapsed_secs=0.307103779
2026-02-03T06:17:38.395492Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T06:17:38.395527Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:17:38.395641Z  INFO ThreadId(13) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:17:38.395716Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T06:17:39.009401Z  INFO ThreadId(04) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.546394ms elapsed_secs=0.307546394
2026-02-03T06:17:39.622695Z  INFO ThreadId(13) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=306.843536ms elapsed_secs=0.306843536
2026-02-03T06:17:39.622909Z ERROR ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T06:17:39.622975Z  INFO ThreadId(13) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T06:17:40.238052Z  INFO ThreadId(04) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=339.190103ms elapsed_secs=0.339190103
2026-02-03T06:17:40.852385Z  INFO ThreadId(04) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=339.251708ms elapsed_secs=0.339251708
2026-02-03T06:17:40.852971Z  INFO ThreadId(04) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T06:17:40.853015Z  INFO ThreadId(04) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:17:40.853126Z  INFO ThreadId(04) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:17:40.853178Z ERROR ThreadId(04) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T06:17:41.465750Z  INFO ThreadId(04) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.480588ms elapsed_secs=0.307480588
2026-02-03T06:17:42.065235Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=291.580668ms elapsed_secs=0.291580668
2026-02-03T06:17:42.065441Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T06:18:06.526759Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T06:18:07.141361Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=278.487433ms elapsed_secs=0.278487433
2026-02-03T06:18:07.142102Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T06:18:07.142143Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T06:18:07.783400Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=370.026726ms elapsed_secs=0.370026726
2026-02-03T06:18:08.348881Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=284.34113ms elapsed_secs=0.28434113
2026-02-03T06:18:08.349400Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T06:18:08.349444Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:18:08.349588Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:18:08.349701Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T06:18:08.914612Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=285.299518ms elapsed_secs=0.285299518
2026-02-03T06:18:09.527957Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=323.118553ms elapsed_secs=0.323118553
2026-02-03T06:18:09.528203Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T06:18:09.528316Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T06:18:10.074807Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=272.181398ms elapsed_secs=0.272181398
2026-02-03T06:18:10.651142Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=283.008536ms elapsed_secs=0.283008536
2026-02-03T06:18:10.651860Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T06:18:10.651909Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:18:10.652052Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:18:10.652184Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T06:18:11.269151Z  INFO ThreadId(04) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=311.065461ms elapsed_secs=0.311065461
2026-02-03T06:18:11.879758Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=327.617451ms elapsed_secs=0.327617451
2026-02-03T06:18:11.879975Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T06:18:36.526068Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T06:18:37.160839Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=291.908596ms elapsed_secs=0.291908596
2026-02-03T06:18:37.161222Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T06:18:37.161239Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T06:18:37.786584Z  INFO ThreadId(04) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=345.475833ms elapsed_secs=0.345475833
2026-02-03T06:18:38.403057Z  INFO ThreadId(04) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=322.029566ms elapsed_secs=0.322029566
2026-02-03T06:18:38.403602Z  INFO ThreadId(04) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T06:18:38.403637Z  INFO ThreadId(04) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:18:38.403734Z  INFO ThreadId(04) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:18:38.403805Z ERROR ThreadId(04) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T06:18:39.016494Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=306.809553ms elapsed_secs=0.306809553
2026-02-03T06:18:39.630632Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=327.569083ms elapsed_secs=0.327569083
2026-02-03T06:18:39.630801Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T06:18:39.630852Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T06:18:40.224685Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=287.401102ms elapsed_secs=0.287401102
2026-02-03T06:18:40.792015Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=288.633151ms elapsed_secs=0.288633151
2026-02-03T06:18:40.792779Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T06:18:40.792835Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:18:40.792941Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:18:40.793038Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T06:18:41.473984Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=308.071049ms elapsed_secs=0.308071049
2026-02-03T06:18:42.087872Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=307.167154ms elapsed_secs=0.307167154
2026-02-03T06:18:42.088087Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T06:28:52.883639Z  INFO ThreadId(01) vscu: src/main.rs:30: Starting VSCU middleware service
2026-02-03T06:28:52.884148Z  WARN ThreadId(01) sqlx_postgres::options::parse: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-postgres-0.8.6/src/options/parse.rs:107: ignoring unrecognized connect parameter key=channel_binding value=require
2026-02-03T06:28:54.959026Z  WARN ThreadId(01) sqlx::pool::acquire: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/pool/inner.rs:302: acquired connection, but time to acquire exceeded slow threshold aquired_after_secs=2.074716117 slow_acquire_threshold_secs=2.0
2026-02-03T06:28:54.960138Z  INFO ThreadId(01) vscu: src/main.rs:64: Server listening on 0.0.0.0:8000
2026-02-03T06:28:54.961175Z  INFO ThreadId(03) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T06:28:55.880794Z  INFO ThreadId(03) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=614.113093ms elapsed_secs=0.614113093
2026-02-03T06:28:55.881181Z  INFO ThreadId(03) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T06:28:55.881201Z  INFO ThreadId(03) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T06:28:58.441522Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=677.350383ms elapsed_secs=0.677350383
2026-02-03T06:28:59.362762Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=615.072743ms elapsed_secs=0.615072743
2026-02-03T06:28:59.363268Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T06:28:59.363309Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:28:59.363452Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:28:59.363584Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T06:28:59.976985Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=303.734823ms elapsed_secs=0.303734823
2026-02-03T06:29:00.591512Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=308.106487ms elapsed_secs=0.308106487
2026-02-03T06:29:00.591871Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T06:29:00.591938Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T06:29:01.205989Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=307.965879ms elapsed_secs=0.307965879
2026-02-03T06:29:01.798362Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=285.936246ms elapsed_secs=0.285936246
2026-02-03T06:29:01.798659Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T06:29:01.798679Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:29:01.798750Z  INFO ThreadId(12) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:29:01.798783Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T06:29:02.435437Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=351.686657ms elapsed_secs=0.351686657
2026-02-03T06:29:03.011480Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=294.490225ms elapsed_secs=0.294490225
2026-02-03T06:29:03.011678Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T06:29:24.960364Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:20: üîÑ Retry worker tick - checking for failed transactions
2026-02-03T06:29:25.873621Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"status\" IN ($1, $2) AND \"sales\".\"retry_count\" < $3\n" rows_affected=2 rows_returned=2 elapsed=604.06091ms elapsed_secs=0.60406091
2026-02-03T06:29:25.874410Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:44: üìã Found 2 failed records to retry
2026-02-03T06:29:25.874448Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 2 (attempt 1/5)
2026-02-03T06:29:26.807131Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=615.968557ms elapsed_secs=0.615968557
2026-02-03T06:29:27.727339Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=611.091639ms elapsed_secs=0.611091639
2026-02-03T06:29:27.728019Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 2 status to PROCESSING
2026-02-03T06:29:27.728058Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:29:27.728182Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:29:27.728258Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 2: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T06:29:28.342696Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=308.314994ms elapsed_secs=0.308314994
2026-02-03T06:29:28.956640Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=306.709685ms elapsed_secs=0.306709685
2026-02-03T06:29:28.956927Z ERROR ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 2: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
2026-02-03T06:29:28.957009Z  INFO ThreadId(12) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:63: üîÑ Retrying record 1 (attempt 1/5)
2026-02-03T06:29:29.494909Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=272.029733ms elapsed_secs=0.272029733
2026-02-03T06:29:30.184813Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1 WHERE \"sales\".\"id\" = $2 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=1 rows_returned=1 elapsed=307.279985ms elapsed_secs=0.307279985
2026-02-03T06:29:30.185520Z  INFO ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:218: ‚úèÔ∏è Updated record 1 status to PROCESSING
2026-02-03T06:29:30.185576Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:29:30.185698Z  INFO ThreadId(11) vscu::utils::crypto: src/utils/crypto.rs:119: Starting the decryption phase!
2026-02-03T06:29:30.185772Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:94: Error during retry of record 1: Decrypt BHF_ID error: AES-GCM-SIV decryption failed: Error. This usually means wrong key or corrupted data.
2026-02-03T06:29:30.764018Z  INFO ThreadId(12) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="SELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", ‚Ä¶" db.statement="\n\nSELECT \"sales\".\"id\", \"sales\".\"api_key\", \"sales\".\"status\", \"sales\".\"generated_invc_no\", \"sales\".\"created_at\", \"sales\".\"updated_at\", \"sales\".\"tin\", \"sales\".\"bhf_id\", \"sales\".\"trd_invc_no\", \"sales\".\"retry_count\", \"sales\".\"next_retry_at\", \"sales\".\"invc_no\", \"sales\".\"org_invc_no\", \"sales\".\"cust_tin\", \"sales\".\"cust_nm\", \"sales\".\"sales_ty_cd\", \"sales\".\"rcpt_ty_cd\", \"sales\".\"pmt_ty_cd\", \"sales\".\"sales_stts_cd\", \"sales\".\"cfm_dt\", \"sales\".\"sales_dt\", \"sales\".\"stock_rls_dt\", \"sales\".\"cncl_req_dt\", \"sales\".\"cncl_dt\", \"sales\".\"rfd_dt\", \"sales\".\"rfd_rsn_cd\", \"sales\".\"tot_item_cnt\", \"sales\".\"taxbl_amt_a\", \"sales\".\"taxbl_amt_b\", \"sales\".\"taxbl_amt_c\", \"sales\".\"taxbl_amt_d\", \"sales\".\"taxbl_amt_e\", \"sales\".\"tax_rt_a\", \"sales\".\"tax_rt_b\", \"sales\".\"tax_rt_c\", \"sales\".\"tax_rt_d\", \"sales\".\"tax_rt_e\", \"sales\".\"tax_amt_a\", \"sales\".\"tax_amt_b\", \"sales\".\"tax_amt_c\", \"sales\".\"tax_amt_d\", \"sales\".\"tax_amt_e\", \"sales\".\"tot_taxbl_amt\", \"sales\".\"tot_tax_amt\", \"sales\".\"tot_amt\", \"sales\".\"prchr_acptc_yn\", \"sales\".\"remark\", \"sales\".\"regr_id\", \"sales\".\"regr_nm\", \"sales\".\"modr_id\", \"sales\".\"modr_nm\", \"sales\".\"receipt\", \"sales\".\"item_list\", \"sales\".\"response\" FROM \"sales\" WHERE \"sales\".\"id\" = $1 LIMIT $2\n" rows_affected=1 rows_returned=1 elapsed=271.047614ms elapsed_secs=0.271047614
2026-02-03T06:29:31.355683Z  INFO ThreadId(11) sqlx::query: /home/mentor/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/sqlx-core-0.8.6/src/logger.rs:143: summary="UPDATE \"sales\" SET \"status\" ‚Ä¶" db.statement="\n\nUPDATE \"sales\" SET \"status\" = $1, \"retry_count\" = $2, \"next_retry_at\" = $3 WHERE \"sales\".\"id\" = $4 RETURNING \"id\", \"api_key\", \"status\", \"generated_invc_no\", \"created_at\", \"updated_at\", \"tin\", \"bhf_id\", \"trd_invc_no\", \"retry_count\", \"next_retry_at\", \"invc_no\", \"org_invc_no\", \"cust_tin\", \"cust_nm\", \"sales_ty_cd\", \"rcpt_ty_cd\", \"pmt_ty_cd\", \"sales_stts_cd\", \"cfm_dt\", \"sales_dt\", \"stock_rls_dt\", \"cncl_req_dt\", \"cncl_dt\", \"rfd_dt\", \"rfd_rsn_cd\", \"tot_item_cnt\", \"taxbl_amt_a\", \"taxbl_amt_b\", \"taxbl_amt_c\", \"taxbl_amt_d\", \"taxbl_amt_e\", \"tax_rt_a\", \"tax_rt_b\", \"tax_rt_c\", \"tax_rt_d\", \"tax_rt_e\", \"tax_amt_a\", \"tax_amt_b\", \"tax_amt_c\", \"tax_amt_d\", \"tax_amt_e\", \"tot_taxbl_amt\", \"tot_tax_amt\", \"tot_amt\", \"prchr_acptc_yn\", \"remark\", \"regr_id\", \"regr_nm\", \"modr_id\", \"modr_nm\", \"receipt\", \"item_list\", \"response\"\n" rows_affected=0 rows_returned=0 elapsed=282.411982ms elapsed_secs=0.282411982
2026-02-03T06:29:31.355896Z ERROR ThreadId(11) vscu::utils::polling_retry_worker: src/utils/polling_retry_worker.rs:97: Failed to increment retry for 1: Query Error: error returned from database: column "next_retry_at" is of type double precision but expression is of type text
